

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>4.5.19. Improving the H\(_2^+\) Variational Approximation by Including Polarization Functions &#8212; Chemistry Lessons with Jupyter Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'physical_chemistry/quantum_mechanics/h2+_with_polarization';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.5.20. The H\(_2\) Molecule using the Variational Method in a Minimal Basis" href="H2_Variational_Minimal_Basis.html" />
    <link rel="prev" title="4.5.18. Improving the H\(_2^+\) Variational Approximation" href="Improving_the_h2%2B_variational_approximation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Chemistry Lessons Using Jupyter Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../jupyter_notebook_tutorials/intro.html">1. Jupyter Notebook Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../jupyter_notebook_tutorials/basic_jupyter_notebook_tutorials.html">1.1. Jupyter Notebook Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jupyter_notebook_tutorials/advanced_jupyter_notebook_tutorials.html">1.2. Advanced Jupyter Notebook Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../coding_concepts/intro.html">2. Coding Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/variables.html">2.1. Variables in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/arrays_and_matrices.html">2.2. Arrays and Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/for_loops.html">2.3. for loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/functions.html">2.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/plotting_with_matplotlib.html">2.5. Plotting with matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/numeric_integration.html">2.6. Numeric Integration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/intro.html">3. Math Concepts in Physical Chemistry</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/logarithms_and_exponential_functions.html">3.1. Logarithms and Exponential Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/differentiation_and_critical_points.html">3.2. Differentiation and Critical Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/integration_in_1D.html">3.3. Integration in 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/derivatives_of_multivariable_functions.html">3.4. Derivatives of Multivariable Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math_concepts_in_physical_chemistry/discrete_probability.html">3.5. Discrete Probability</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../intro.html">4. Physical Chemistry</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../introduction/intro.html">4.1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/non-bonded_interactions.html">4.1.1. Non-bonded Interactions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../statistical_thermodynamics/intro.html">4.2. Statiscial Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Boltzmann_Factor.html">4.2.1. Boltzmann Factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Introduction_to_Probability.html">4.2.2. Introduction to Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Thermodynamic_Properties_from_Partition_Function.html">4.2.3. Thermodynamic Properties from the Partition Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Partition_Function_Monatomic_Ideal_Gas.html">4.2.4. Partition Function for a Monatomic Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Partition_Function_Diatomic_Ideal_Gas.html">4.2.5. Partition Function for a Diatomic Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Classical_Monatomic_Ideal_Gas.html">4.2.6. Classical Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Kinetic_Theory_of_Gasses_from_Classical_Ideal_Gas_Partition_Function.html">4.2.7. Kinetic Theory of Gasses from the Classical Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/microscopic_view_of_entropy.html">4.2.8. Microscopic View of Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Equations_of_State_From_Lattice_Gas.html">4.2.9. Equations of State from Lattice Gas Models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../thermodynamics/intro.html">4.3. Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/First_Law_of_Thermodynamics.html">4.3.1. The First Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Heat_Work_and_Calculating_U.html">4.3.2. Heat Work and Calculating <span class="math notranslate nohighlight">\(\Delta U\)</span></a></li>

<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Thermodynamic_Cycles.html">4.3.4. Thermodynamic Cycles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Eastham_Honors.html">4.3.5. Thermodynamic Cycles: Solving exam problems and other examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Enthalpy.html">4.3.6. Enthalpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/The_Carnot_Cycle.html">4.3.7. The Carnot Cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Second_Law_of_Thermodynamics.html">4.3.8. Second Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Heat_Engine_Diagrams_and_Microscopic_view_Entropy.html">4.3.9. Heat Engine Diagrams</a></li>

<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Third_Law_of_Thermodynamics.html">4.3.11. The Third Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/First_Derivative_and_Maxwell_Relations_of_Thermodynamic_Energy_Functions.html">4.3.12. First Derivative and Maxwell Relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Maxwell_Relations_Applied.html">4.3.13. Maxwell Relations Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Free_Energy_and_Legendre_Transforms.html">4.3.14. Free Energy and Legendre Transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Pressure_and_Temperature_Dependence_Gibbs_Energy.html">4.3.15. The Pressure and Temperature Dependence of the Gibbs Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Phase_Diagrams_and_Phase_Equilibria.html">4.3.16. Phase Diagrams and Phase Equilibria</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Chemical_Potential_from_Partition_Function.html">4.3.17. Chemical Potential from the Partition Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Thermodynamics_of_Solutions.html">4.3.18. Thermodynamics of Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Ideal_and_Non_Ideal_Solutions.html">4.3.19. Ideal and Non-ideal Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Introduction_to_Chemical_Equilibrium.html">4.3.20. Chemical Equilibrium</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../kinetics/intro.html">4.4. Kinetics</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Chemical_Kinetics_and_Rate_Laws.html">4.4.1. Chemical Kinetics and Rate Laws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Integrated_Rate_Laws.html">4.4.2. Integrated Rate Laws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Reversible_Reactions.html">4.4.3. Reversible Reactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Transition_State_Theory_and_Temperature_Dependence_of_the_Rate_Constant.html">4.4.4. Transition State Theory and Temperature Dependence of the Rate Constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Reaction_Mechanisms_Part_I.html">4.4.5. Reaction Mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Catalysts.html">4.4.6. Catalysts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Enzyme_Kinetics_Michaelis_Menten.html">4.4.7. Enzyme Kinetics: The Michaelis-Menten Mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Cooperative_Binding_Kinetics.html">4.4.8. Cooperative Binding Kinetics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Competitive_Inhibition.html">4.4.9. Competitive Inhibition</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="intro.html">4.5. Quantum Mechanics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="history_of_quantum_mechanics.html">4.5.1. The History of Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_particle_duality_classical_wave_equation.html">4.5.2. Wave Particle Duality and the Classical Wave Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Schrodinger_Equation.html">4.5.3. Schrodinger Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="particle_in_a_box.html">4.5.4. Particle in a Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="uncertainty_principle_and_applications_of_particle_in_a_box.html">4.5.5. The Uncertainty Principle and Applications of Particle in a Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="postulates_of_quantum_mechanics.html">4.5.6. The Postulates and Formalism of Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="momentum_operator.html">4.5.7. The Momentum Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="operator_algebra.html">4.5.8. Operator Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="particle_in_a_sphere.html">4.5.9. Particle in a Sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties_of_particle_in_a_sphere.html">4.5.10. Properties of Particle in a Sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_hydrogen_atom.html">4.5.11. The Hydrogen Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties_of_the_hydrogen_atom.html">4.5.12. Properties of the Hydrogen Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_hydrogen_atom_absorption_spectrum.html">4.5.13. The Hydrogen Atom Absorption Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="special_functions_in_quantum_mechanics.html">4.5.14. Special Functions in Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_helium_atom.html">4.5.15. The Helium Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="variational_method_in_quantum_mechanics.html">4.5.16. Variational Method in Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Single_Electron_Molecule_Variational_Approach.html">4.5.17. Single Electron Molecule in the Variational Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="Improving_the_h2%2B_variational_approximation.html">4.5.18. Improving the H<span class="math notranslate nohighlight">\(_2^+\)</span> Variational Approximation</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">4.5.19. Improving the H<span class="math notranslate nohighlight">\(_2^+\)</span> Variational Approximation by Including Polarization Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="H2_Variational_Minimal_Basis.html">4.5.20. The H<span class="math notranslate nohighlight">\(_2\)</span> Molecule using the Variational Method in a Minimal Basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="H2_Configuration_Interaction.html">4.5.21. H<span class="math notranslate nohighlight">\(_2\)</span> Configuration Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonic_oscillator.html">4.5.22. Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="quantum_mechanics_of_vibrational_spectroscopy.html">4.5.23. Vibrational Spectroscopy</a></li>
<li class="toctree-l3"><a class="reference internal" href="basis_functions.html">4.5.24. Basis Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonic_oscillator_using_variational_method.html">4.5.25. Variational Solution to the Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="morse_oscillator.html">4.5.26. The Morse Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator.html">4.5.27. Rigid Rotator</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator_using_variational_method.html">4.5.28. Rigid Rotator Variational Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator_selection_rules.html">4.5.29. Rigid Rotator Continued…</a></li>

</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../electronic_structure/intro.html">4.6. Electronic Structure</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../electronic_structure/Hartree_Fock_Helium_Atom.html">4.6.1. Hartree-Fock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../electronic_structure/HF_for_H2.html">4.6.2. Hartree-Fock Code for the H2 Molecule in a Minimal STO-3G basis</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/mccullaghlab/mccullaghlab.github.io/main?urlpath=tree/Chemistry_Lessons_Jupyter_Notebooks/physical_chemistry/quantum_mechanics/h2+_with_polarization.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/mccullaghlab/mccullaghlab.github.io/blob/main/Chemistry_Lessons_Jupyter_Notebooks/physical_chemistry/quantum_mechanics/h2+_with_polarization.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/mccullaghlab/mccullaghlab.github.io/issues/new?title=Issue%20on%20page%20%2Fphysical_chemistry/quantum_mechanics/h2+_with_polarization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/physical_chemistry/quantum_mechanics/h2+_with_polarization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Improving the H_2^+ Variational Approximation by Including Polarization Functions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authorship">4.5.19.1. Authorship:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">4.5.19.2. Motivation:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">4.5.19.3. Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-concepts">4.5.19.4. Coding Concepts:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-model">4.5.19.5. Setting up the Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-polarization">4.5.19.6. Adding Polarization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-expectation-of-the-hamiltonian">4.5.19.7. Determining the Expectation of the Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#s-ab-z-1-z-2-a-r">4.5.19.7.1. <span class="math notranslate nohighlight">\(S_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#left-langle-phi-a-mid-hat-h-mid-phi-a-right-rangle">4.5.19.7.2. <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-aa-z-1-z-2-a">4.5.19.7.2.1. <span class="math notranslate nohighlight">\(T_{AA}(Z_1,Z_2,a)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#j-aa-z-1-z-2-a">4.5.19.7.2.2. <span class="math notranslate nohighlight">\(J_{AA}(Z_1,Z_2,a)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#j-ab-z-1-z-2-a-r">4.5.19.7.2.3. <span class="math notranslate nohighlight">\(J_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#left-langle-phi-a-mid-hat-h-mid-phi-b-right-rangle">4.5.19.7.3. <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle\)</span>.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-ab-z-1-z-2-a-r">4.5.19.7.3.1. <span class="math notranslate nohighlight">\(K_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-ab-z1-z2-a-r">4.5.19.7.3.2. <span class="math notranslate nohighlight">\(T_{AB}(Z1,Z2,a,R)\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-coulomb-and-exchange-functions">4.5.19.8. Overlap, Coulomb, and Exchange Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#total-energy">4.5.19.9. Total Energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-the-code">4.5.19.10. Combining the Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphed-comparisons-of-polarization-to-lcao-and-slater-bases">4.5.19.11. Graphed comparisons of Polarization to LCAO and Slater bases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-plots">4.5.19.11.1. Energy Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orbital-densities">4.5.19.11.2. Orbital Densities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">4.5.19.12. 4.5.19.8 Appendix</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="improving-the-h-2-variational-approximation-by-including-polarization-functions">
<h1><span class="section-number">4.5.19. </span>Improving the H<span class="math notranslate nohighlight">\(_2^+\)</span> Variational Approximation by Including Polarization Functions<a class="headerlink" href="#improving-the-h-2-variational-approximation-by-including-polarization-functions" title="Permalink to this heading">#</a></h1>
<section id="authorship">
<h2><span class="section-number">4.5.19.1. </span>Authorship:<a class="headerlink" href="#authorship" title="Permalink to this heading">#</a></h2>
<p>This notebook was written and contributed by <strong>Micah Miles</strong> in 2025 as part of his honors contract for Physical Chemistry II.</p>
</section>
<section id="motivation">
<h2><span class="section-number">4.5.19.2. </span>Motivation:<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>Both the <a class="reference internal" href="Single_Electron_Molecule_Variational_Approach.html"><span class="doc std std-doc">linear combination of atomic orbital</span></a> (LCAO), and <a class="reference internal" href="Improving_the_h2%2B_variational_approximation.html"><span class="doc std std-doc">Slater orbital descriptions</span></a> of the H<span class="math notranslate nohighlight">\(_2^+\)</span> molecule give reasonable approximations of bond formation. However, these models lack quantitative accuracy and some of the intuitive qualitative character describing how orbitals might change near bond distance. The Slater type orbital modifies the LCAO basis by improving the existing exponential function representative of the Hydrogen 1s orbital. In these notes, we will improve upon that basis by adding a function which allows for dileniation of the orbitals from strict spherical structure (polarization functions).</p>
</section>
<section id="learning-goals">
<h2><span class="section-number">4.5.19.3. </span>Learning Goals:<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>After working through these notes, you will be able to:</p>
<ol class="arabic simple">
<li><p>Define the difference between Hydrogen atom 1s, Slater 1s, and Slater 2p<span class="math notranslate nohighlight">\(_z\)</span> orbitals.</p></li>
<li><p>Describe how the addition of Slater 2p<span class="math notranslate nohighlight">\(_z\)</span> orbitals allows us to get an improved variational result for the H<span class="math notranslate nohighlight">\(_2^+\)</span> molecule as compared to only utilizing hydrogen-atom or Slater 1s orbitals.</p></li>
<li><p>Describe what it means to include polarization functions in atomic orbitals, and how optimizing the polarized basis set provides insight to the structure of a real chemical bond.</p></li>
</ol>
</section>
<section id="coding-concepts">
<h2><span class="section-number">4.5.19.4. </span>Coding Concepts:<a class="headerlink" href="#coding-concepts" title="Permalink to this heading">#</a></h2>
<p>The following coding concepts are used in this notebook:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="../../coding_concepts/variables.html"><span class="doc std std-doc">Variables</span></a></p></li>
<li><p><a class="reference internal" href="../../coding_concepts/functions.html"><span class="doc std std-doc">Functions</span></a></p></li>
<li><p><a class="reference internal" href="../../coding_concepts/plotting_with_matplotlib.html"><span class="doc std std-doc">Plotting with matplotlib</span></a></p></li>
</ol>
</section>
<section id="setting-up-the-model">
<h2><span class="section-number">4.5.19.5. </span>Setting up the Model<a class="headerlink" href="#setting-up-the-model" title="Permalink to this heading">#</a></h2>
<p>We consider the H<span class="math notranslate nohighlight">\(_2^+\)</span> molecule in the Born-Oppenheimer approximation with Hamiltonian:</p>
<div class="amsmath math notranslate nohighlight" id="equation-204b02cd-e94b-4cf4-9000-c376ce48d16d">
<span class="eqno">(4.949)<a class="headerlink" href="#equation-204b02cd-e94b-4cf4-9000-c376ce48d16d" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat{H} = -\frac{1}{2}\nabla^2 - \frac{1}{r_A} - \frac{1}{r_B} + \frac{1}{R}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_A\)</span> and <span class="math notranslate nohighlight">\(r_B\)</span> are the distances between the electron and nuclei <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, respectively, and <span class="math notranslate nohighlight">\(R\)</span> is the distance between the two nuclei.</p>
<p>In order to solve for the energy and wavefunction as a function of nuclear separation distance <span class="math notranslate nohighlight">\(R\)</span>, we will consider the normalized trial wave function:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0b995c73-3b72-41bb-b8f2-07a63cceb629">
<span class="eqno">(4.950)<a class="headerlink" href="#equation-0b995c73-3b72-41bb-b8f2-07a63cceb629" title="Permalink to this equation">#</a></span>\[\begin{equation}
\psi_+ = \frac{1}{\sqrt{2(1+S_{AB})}}\left( \phi_A + \phi_B \right)
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_A\)</span> and <span class="math notranslate nohighlight">\(\phi_B\)</span> are the atom-centered basis functions and <span class="math notranslate nohighlight">\(S_{AB}\)</span> is the basis overlap integral defined by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4d25b7ad-6968-4c71-8ec0-770f87cce565">
<span class="eqno">(4.951)<a class="headerlink" href="#equation-4d25b7ad-6968-4c71-8ec0-770f87cce565" title="Permalink to this equation">#</a></span>\[\begin{equation}
S_{AB} = \left\langle \phi_A \mid \phi_B\right\rangle.
\end{equation}\]</div>
<p>Note that thus far, the setup to the problem aligns exactly with the LCAO and Slater bases. Remember that in these notes, we will consider going beyond the minimal <span class="math notranslate nohighlight">\(1s\)</span> atomic basis by including <span class="math notranslate nohighlight">\(2p_z\)</span> functions to allow for <em>polarization</em>.</p>
</section>
<section id="adding-polarization">
<h2><span class="section-number">4.5.19.6. </span>Adding Polarization<a class="headerlink" href="#adding-polarization" title="Permalink to this heading">#</a></h2>
<p>Polarization will be added to our atomic centered basis functions in the form of a linear combination of <span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_z\)</span> slater-type orbitals (STOs) on each nucleus. Though the <span class="math notranslate nohighlight">\(2p_z\)</span> functions we utilize also come from STOs, the term “Slater” will be used here on to denote the Slater <span class="math notranslate nohighlight">\(1s\)</span> only basis set. Thus, the normalized basis functions are:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5d9ea2c3-7b6f-409c-856e-e82d737f7e87">
<span class="eqno">(4.952)<a class="headerlink" href="#equation-5d9ea2c3-7b6f-409c-856e-e82d737f7e87" title="Permalink to this equation">#</a></span>\[\begin{align}
\phi_A &amp;= \frac{1}{\sqrt{1+a^2}}\left(1s_A + a\cdot2p_{zA}\right) \\
\phi_B &amp;= \frac{1}{\sqrt{1+a^2}}\left(1s_B + a\cdot2p_{zB}\right)
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is a variational paramter that controls the amount of <span class="math notranslate nohighlight">\(p\)</span> character in the molecular orbital, <span class="math notranslate nohighlight">\(1s_A\)</span> is the <span class="math notranslate nohighlight">\(1s\)</span> STO centered on nucleus <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(2p_{zA}\)</span> is the <span class="math notranslate nohighlight">\(2p_z\)</span> STO centered on nucleus <span class="math notranslate nohighlight">\(A\)</span>. Let us take a moment to discuss the addition of the <span class="math notranslate nohighlight">\(a\)</span> parameter. As is central to the variational method, this parameter will need to be optimized, in this case for many discrete values of <span class="math notranslate nohighlight">\(R\)</span>. How do you think <span class="math notranslate nohighlight">\(a\)</span> will change as <span class="math notranslate nohighlight">\(R\)</span> changes? Will <span class="math notranslate nohighlight">\(a\)</span> be highest near bonding distance, at infinite separation, or somewherre in between? We will discuss this further during the energy optimization steps, but it is good practice to consider this now.<br />
<br />
Next, we must define our <span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_Z\)</span> functions. Note that the <span class="math notranslate nohighlight">\(1s\)</span> functions look very similar to what we used for the Slater basis, with one notable change (try to spot and understand that change before checking below the functions for an explanation). The normalized functional forms of these are:</p>
<div class="amsmath math notranslate nohighlight" id="equation-00434d99-a819-4b61-9237-08b323b58e67">
<span class="eqno">(4.953)<a class="headerlink" href="#equation-00434d99-a819-4b61-9237-08b323b58e67" title="Permalink to this equation">#</a></span>\[\begin{align}
1s_A &amp;= \left( \frac{Z_1^3}{\pi}\right)^{1/2}e^{-Z_1r_A} \\
1s_B &amp;= \left( \frac{Z_1^3}{\pi}\right)^{1/2}e^{-Z_1r_B} \\
2p_{zA} &amp;= \left( \frac{Z_2^5}{\pi}\right)^{1/2} r_A\cos\theta_A e^{-Z_2r_A} \\
2p_{zB} &amp;= \left( \frac{Z_2^5}{\pi}\right)^{1/2} r_B\cos\theta_B e^{-Z_2r_B}
\end{align}\]</div>
<p>If you looked back at the notes for the Slater type orbitals, you might have noticed that <span class="math notranslate nohighlight">\(Z\)</span> was the only variational parameter related to effective nuclear charge. Here, we utilize <span class="math notranslate nohighlight">\(Z_1\)</span> and <span class="math notranslate nohighlight">\(Z_2\)</span> in order to allow our basis set to account for differing effective charge applied to the <span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_z\)</span> orbitals. There are two major possibilities this addition introduces. First, that <span class="math notranslate nohighlight">\(Z_1\)</span> and <span class="math notranslate nohighlight">\(Z_2\)</span> do not differ, and we give ourselves extra work in calculating constants and scalar terms in the upcoming integrals. Second, that effective charge does vary between the orbital types in our model, and the extra consideration allows for a more accurate variational approximation. Remember that adding to the basis in this way is either neutral (not accounting for the extra legwork) or productive, it cannot act as a detriment to our overall approach. Spoiler alert: in this case it is productive, as we will show that <span class="math notranslate nohighlight">\(Z_1\)</span> and <span class="math notranslate nohighlight">\(Z_2\)</span> values vary widely from each other at most <span class="math notranslate nohighlight">\(R\)</span> values in the optimized model.<br />
<br />
Another new feature of our basis set is the inclusion of theta (<span class="math notranslate nohighlight">\(\theta\)</span>) as a variable for our p-orbital representatives. This <span class="math notranslate nohighlight">\(\theta\)</span> is effectively the same as that which we used to characterize the Hydrogen atom in spherical polar coordinates. It is measured from the positive z-axis to the xy-plane, and takes on values from Zero to <span class="math notranslate nohighlight">\(\pi\)</span>. <br />
<br />
Now, we know our Hamiltonian and have described our basis set. As we did for the LCAO and Slater bases, We will start by determining an equation for the energy in terms of integrals, such as <span class="math notranslate nohighlight">\(S_{AB}\)</span>.  We will determine specific functional forms of those integrals in subsequent subsections.</p>
</section>
<section id="determining-the-expectation-of-the-hamiltonian">
<h2><span class="section-number">4.5.19.7. </span>Determining the Expectation of the Hamiltonian<a class="headerlink" href="#determining-the-expectation-of-the-hamiltonian" title="Permalink to this heading">#</a></h2>
<p>We will determine the expectation value of the Hamiltonian in this basis.  Namely:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ab49cb65-a8f0-4ef8-9c87-897eb7e27f5c">
<span class="eqno">(4.954)<a class="headerlink" href="#equation-ab49cb65-a8f0-4ef8-9c87-897eb7e27f5c" title="Permalink to this equation">#</a></span>\[\begin{equation}
E_{\psi_+} = \left\langle \psi_+ \mid \hat{H} \mid \psi_+ \right\rangle
\end{equation}\]</div>
<p>Convince yourself that the equation above is an appropriate representation for the expectation value of the Hamiltonian (i.e. Why do we not need to consider dividing by the overlap integral?). Continuing on, we will start by just separating the terms:</p>
<div class="amsmath math notranslate nohighlight" id="equation-727d7ec3-2498-472c-be61-04ca861ac771">
<span class="eqno">(4.955)<a class="headerlink" href="#equation-727d7ec3-2498-472c-be61-04ca861ac771" title="Permalink to this equation">#</a></span>\[\begin{align}
E_{\psi_+} &amp;= \frac{1}{2(1+S_{AB})}\left\langle \phi_A + \phi_B \mid \hat{H} \mid \phi_A + \phi_B \right\rangle \\
&amp;= \frac{1}{2(1+S_{AB})}\left[ \left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle + \left\langle \phi_B \mid \hat{H} \mid \phi_B \right\rangle + \left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle + \left\langle \phi_B \mid \hat{H} \mid \phi_A \right\rangle\right] \\
&amp;= \frac{1}{(1+S_{AB})}\left[ \left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle + \left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle \right] \\
\end{align}\]</div>
<p>Consider how the Hermitian nature of our model, and real-valued basis set contribute to the manipulations made above (i.e. What if we did not use a Hermitian operator, or included functions with imaginary components?). <br />
<br />
We will determine expressions for these integrals below. Like much of the work we have done so far in this course, there is no single correct starting point or approach to evaluating individual integrals. For these notes, we will break up the hamiltonian across addition. Additionally, we will start with the <span class="math notranslate nohighlight">\(S_{AB}\)</span> integral, as we will find it (or its substituents) pops up in some of the other integrations and will need to be called upon.</p>
<section id="s-ab-z-1-z-2-a-r">
<h3><span class="section-number">4.5.19.7.1. </span><span class="math notranslate nohighlight">\(S_{AB}(Z_1,Z_2,a,R)\)</span><a class="headerlink" href="#s-ab-z-1-z-2-a-r" title="Permalink to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-32c66a1f-232d-4e6e-a0ac-6f2849b17088">
<span class="eqno">(4.956)<a class="headerlink" href="#equation-32c66a1f-232d-4e6e-a0ac-6f2849b17088" title="Permalink to this equation">#</a></span>\[\begin{align}
S_{AB}(Z1,Z2,a,R) &amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid 1s_B+ a\cdot2p_{zB} \right\rangle \\
 &amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A  \mid 1s_B \right\rangle + a\left\langle 1s_A  \mid 2p_{zB} \right\rangle + a\left\langle 2p_{zA} \mid 1s_B \right\rangle + a^2\left\langle 2p_{zA} \mid 2p_{zB} \right\rangle\right] \\
  &amp;= \frac{1}{1+a^2}\left[ S_{1s-1s}(Z_1,R) + 2aS_{1s-2p}(Z_1,Z_2,R) + a^2S_{2p-2p}(Z_2,R)\right] 
\end{align}\]</div>
<p>Here, we see that the <span class="math notranslate nohighlight">\(S_{AB}\)</span> integral breaks into three distinct overlap (<span class="math notranslate nohighlight">\(S\)</span> ) functions. The functional forms of these integrals are described in a table later in these notes. You can also check out the functions and how they are expressed/nested in the code below, which we will eventually compile for energy minimization (and to call upon <span class="math notranslate nohighlight">\(S_{AB}\)</span> for other integrals).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">THRESH</span> <span class="o">=</span> <span class="mf">1e-8</span>

<span class="k">def</span> <span class="nf">S_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">w</span> <span class="o">+</span> <span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I7</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I8</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">I1</span><span class="o">*</span><span class="n">I7</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="n">I8</span> <span class="o">-</span> <span class="n">I3</span><span class="o">*</span><span class="n">I5</span> <span class="o">-</span> <span class="n">I4</span><span class="o">*</span><span class="n">I6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">S_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We have discussed in class before how checking your functions along the way while doing such involved and numerous integrations can be useful to ensure you are not baking incorrect functions into your code from the beginning. Below, we plot each of our individual <span class="math notranslate nohighlight">\(S\)</span>-type functions, and the combined <span class="math notranslate nohighlight">\(S_{AB}\)</span> function with a chosen <span class="math notranslate nohighlight">\(a\)</span> value.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">S_1s_basis</span> <span class="o">=</span> <span class="n">S_1s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">S_2p_basis</span> <span class="o">=</span> <span class="n">S_2p</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">S_1s_2p_basis</span> <span class="o">=</span> <span class="n">S_1s_2p</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">S_combined</span> <span class="o">=</span> <span class="n">S_AB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">S_1s_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;S - 1s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">S_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;S - 2p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">S_1s_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;S - 1s-2p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">S_combined</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;S$_</span><span class="si">{AB}</span><span class="s1">$ - a=0.15&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;S for H$_2^+$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f8d4c5c52b95e38dd1d70d9019495463e6c639f58a91831274fbf70dd23a8a43.png" src="../../_images/f8d4c5c52b95e38dd1d70d9019495463e6c639f58a91831274fbf70dd23a8a43.png" />
</div>
</div>
<p>After plotting, everything seems in order, and several characteristics help us to corroborate. First, we expect all overlap functions to approach zero as <span class="math notranslate nohighlight">\(R\)</span> approaches infinity. From our previous experience with <span class="math notranslate nohighlight">\(1s\)</span> orbitals, we expect the <span class="math notranslate nohighlight">\(1s\)</span> overlap to approach one as <span class="math notranslate nohighlight">\(R\)</span> approaches zero. One feature that may not be as readily understood is the <span class="math notranslate nohighlight">\(2p_Z\)</span> overlap behavior. Since p-orbitals have parity (positive and negative, or bonding and anti-bonding lobes), and we aim to simulate bonding, the lobes of opposite parity will overlap at <span class="math notranslate nohighlight">\(R=0\)</span>, leading to a value of <span class="math notranslate nohighlight">\(-1\)</span>.<br />
<br />
This plot also gives us some initial physical insight to how this model improves upon the LCAO and Slater basis. Note that the overall overlap increases faster than for the Slater overlap as R decreases from infinity, signaling stronger interactions at larger nuclear separation. <br />
<br />
Now, we will move on to expanding and solving <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle\)</span>.</p>
</section>
<section id="left-langle-phi-a-mid-hat-h-mid-phi-a-right-rangle">
<h3><span class="section-number">4.5.19.7.2. </span><span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle\)</span><a class="headerlink" href="#left-langle-phi-a-mid-hat-h-mid-phi-a-right-rangle" title="Permalink to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-c9a46254-f312-47a3-8963-5b22e0efe9da">
<span class="eqno">(4.957)<a class="headerlink" href="#equation-c9a46254-f312-47a3-8963-5b22e0efe9da" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle &amp;= \left\langle \phi_A \mid -\frac{1}{2}\nabla^2 \mid \phi_A \right\rangle + \left\langle \phi_A \mid -\frac{1}{r_A} \mid \phi_A \right\rangle + \left\langle \phi_A \mid -\frac{1}{r_B} \mid \phi_A \right\rangle + \left\langle \phi_A \mid \frac{1}{R} \mid \phi_A \right\rangle \\
 &amp;= T_{AA}(Z_1,Z_2,a) + J_{AA}(Z_1,Z_2,a) + J_{AB}(Z_1,Z_2,a,R) + \frac{1}{R}
\end{align}\]</div>
<section id="t-aa-z-1-z-2-a">
<h4><span class="section-number">4.5.19.7.2.1. </span><span class="math notranslate nohighlight">\(T_{AA}(Z_1,Z_2,a)\)</span><a class="headerlink" href="#t-aa-z-1-z-2-a" title="Permalink to this heading">#</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-77540187-abb2-48e6-807e-b782ba0db5b3">
<span class="eqno">(4.958)<a class="headerlink" href="#equation-77540187-abb2-48e6-807e-b782ba0db5b3" title="Permalink to this equation">#</a></span>\[\begin{align}
T_{AA}(Z_1,Z_2,a) &amp;= \left\langle \phi_A \mid -\frac{1}{2}\nabla^2 \mid \phi_A \right\rangle \\
&amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 1s_A + a\cdot2p_{zA} \right\rangle \\
&amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A  \mid -\frac{1}{2}\nabla^2 \mid 1s_A \right\rangle + a\left\langle 1s_A  \mid -\frac{1}{2}\nabla^2 \mid 2p_{zA} \right\rangle + a\left\langle 2p_{zA}  \mid -\frac{1}{2}\nabla^2 \mid 1s_A \right\rangle + a^2\left\langle 2p_{zA}  \mid -\frac{1}{2}\nabla^2 \mid 2p_{zA} \right\rangle\right]
\end{align}\]</div>
<p>We will need:</p>
<div class="amsmath math notranslate nohighlight" id="equation-119d1004-bdce-454f-99dd-b97ce6842b69">
<span class="eqno">(4.959)<a class="headerlink" href="#equation-119d1004-bdce-454f-99dd-b97ce6842b69" title="Permalink to this equation">#</a></span>\[\begin{align}
-\frac{1}{2}\nabla^2e^{-Z_1r_A} &amp;= \left(\frac{Z_1}{r_A} - \frac{Z_1^2}{2}\right)e^{-Z_1r_A} \\
\left(-\frac{1}{2}\nabla^2\right) r_A\cos\theta_A e^{-Z_2r_A} &amp;=\left[2Z_2-\frac{Z_2^2r_A}{2} \right]\cos\theta_A e^{-Z_2r_A}
\end{align}\]</div>
<p>The otuputs (above) of operating the kinetic energy term on the <span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_z\)</span> are useful for the following, and later on in our calculations.</p>
<div class="amsmath math notranslate nohighlight" id="equation-118ccad4-40a4-4371-a2b3-d6ad97464d74">
<span class="eqno">(4.960)<a class="headerlink" href="#equation-118ccad4-40a4-4371-a2b3-d6ad97464d74" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 1s_A \mid -\frac{1}{2}\nabla^2 \mid 1s_A \right\rangle =&amp; \left( \frac{Z_1^3}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^2\sin\theta_Ae^{-Z_1r_A}\left(-\frac{1}{2}\nabla^2\right) e^{-Z_1r_A}  dr_A d\theta_A d\phi_A \\
=&amp; \frac{Z_1^2}{2} 
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-6f0e209e-0214-4aa7-bebe-ac4ebea4a12c">
<span class="eqno">(4.961)<a class="headerlink" href="#equation-6f0e209e-0214-4aa7-bebe-ac4ebea4a12c" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 1s_A \right\rangle &amp;= \left( \frac{Z_1^{3/2}Z_2^{5/2}}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^2\sin\theta_Ar_A\cos\theta_A e^{-Z_2r_A}\left(-\frac{1}{2}\nabla^2\right) e^{-Z_1r_A}  dr_A d\theta_A d\phi_A \\
=&amp; 0
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-f30be3ea-0fc6-418e-9734-772d4d4104ad">
<span class="eqno">(4.962)<a class="headerlink" href="#equation-f30be3ea-0fc6-418e-9734-772d4d4104ad" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 1s_{A} \mid -\frac{1}{2}\nabla^2 \mid 2p_{zA} \right\rangle &amp;= \left( \frac{Z_1^{3/2}Z_2^{5/2}}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^2\sin\theta_A  e^{-Z_1r_A}\left(-\frac{1}{2}\nabla^2\right)  r_A\cos\theta_A e^{-Z_2r_A}dr_A d\theta_A d\phi_A \\
&amp;= 0
\end{align}\]</div>
<p>Both of the above follow because:</p>
<div class="amsmath math notranslate nohighlight" id="equation-17b60c02-5bbd-48ff-88ec-06463c625d22">
<span class="eqno">(4.963)<a class="headerlink" href="#equation-17b60c02-5bbd-48ff-88ec-06463c625d22" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_0^\pi\sin\theta\cos\theta d\theta = 0
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-e43be138-9ff4-4b5a-9f11-df94c896594a">
<span class="eqno">(4.964)<a class="headerlink" href="#equation-e43be138-9ff4-4b5a-9f11-df94c896594a" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 2p_{zA} \right\rangle &amp;= \left( \frac{Z_2^5}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^3\sin\theta_A\cos^2\theta_A e^{-2Z_2r_A}  \left[2Z_2-\frac{Z_2^2r_A}{2} \right] dr_A d\theta_A d\phi_A \\
&amp;=  \frac{Z_2^2}{2}  
\end{align}\]</div>
<p>Thus:</p>
<div class="amsmath math notranslate nohighlight" id="equation-86f27701-3eac-49bd-a5e2-a5f256a08df1">
<span class="eqno">(4.965)<a class="headerlink" href="#equation-86f27701-3eac-49bd-a5e2-a5f256a08df1" title="Permalink to this equation">#</a></span>\[\begin{align}
T_{AA}(Z_1,Z_2,a) &amp;= \frac{Z_1^2+a^2Z_2^2}{2(1+a^2)}
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Z1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="j-aa-z-1-z-2-a">
<h4><span class="section-number">4.5.19.7.2.2. </span><span class="math notranslate nohighlight">\(J_{AA}(Z_1,Z_2,a)\)</span><a class="headerlink" href="#j-aa-z-1-z-2-a" title="Permalink to this heading">#</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-28a550ed-a6aa-477f-870f-b1328b9d560f">
<span class="eqno">(4.966)<a class="headerlink" href="#equation-28a550ed-a6aa-477f-870f-b1328b9d560f" title="Permalink to this equation">#</a></span>\[\begin{align}
J_{AA}(Z_1,Z_2,a) &amp;= \left\langle \phi_A \mid -\frac{1}{r_A} \mid \phi_A \right\rangle \\
&amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid -\frac{1}{r_A} \mid 1s_A + a\cdot2p_{zA} \right\rangle \\
&amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A  \mid -\frac{1}{r_A} \mid 1s_A \right\rangle + a\left\langle 1s_A  \mid -\frac{1}{r_A} \mid 2p_{zA} \right\rangle + a\left\langle 2p_{zA}  \mid -\frac{1}{r_A} \mid 1s_A \right\rangle + a^2\left\langle 2p_{zA}  \mid -\frac{1}{r_A} \mid 2p_{zA} \right\rangle\right]
\end{align}\]</div>
<p>This middle two terms will again be zero for the same argument as the <span class="math notranslate nohighlight">\(T\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-603f9f2e-c3e4-4b08-abf1-db4c8aa51336">
<span class="eqno">(4.967)<a class="headerlink" href="#equation-603f9f2e-c3e4-4b08-abf1-db4c8aa51336" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 1s_A \mid -\frac{1}{r_A} \mid 1s_A \right\rangle =&amp; \left( \frac{Z_1^3}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^2\sin\theta_Ae^{-Z_1r_A}\left(-\frac{1}{r_A}\right) e^{-Z_1r_A}  dr_A d\theta_A d\phi_A \\
=&amp; -Z_1 
\end{align}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-cfc249e8-6f31-451f-9845-9e1f4244d17f">
<span class="eqno">(4.968)<a class="headerlink" href="#equation-cfc249e8-6f31-451f-9845-9e1f4244d17f" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 2p_{zA} \mid -\frac{1}{r_A} \mid 2p_{zA} \right\rangle &amp;= -\left( \frac{Z_2^5}{\pi}\right) \int_0^\infty\int_0^{2\pi}\int_0^\pi r_A^3\sin\theta_A\cos^2\theta_A e^{-2Z_2r_A}  dr_A d\theta_A d\phi_A \\
&amp;=  -\frac{Z_2}{2} 
\end{align}\]</div>
<p>Thus,</p>
<div class="amsmath math notranslate nohighlight" id="equation-658fa234-0f43-4dda-b0a4-9a6edca6b9e1">
<span class="eqno">(4.969)<a class="headerlink" href="#equation-658fa234-0f43-4dda-b0a4-9a6edca6b9e1" title="Permalink to this equation">#</a></span>\[\begin{align}
J_{AA}(Z_1,Z_2,a) &amp;=  \frac{-1}{1+a^2}\left[ Z_1  + a^2\frac{Z_2}{2}\right]
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">Z1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="j-ab-z-1-z-2-a-r">
<h4><span class="section-number">4.5.19.7.2.3. </span><span class="math notranslate nohighlight">\(J_{AB}(Z_1,Z_2,a,R)\)</span><a class="headerlink" href="#j-ab-z-1-z-2-a-r" title="Permalink to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(\left\langle \phi_A \mid -\frac{1}{r_B} \mid \phi_A \right\rangle\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-dbc1a43a-6a18-4eb8-99db-64f5bf8191c2">
<span class="eqno">(4.970)<a class="headerlink" href="#equation-dbc1a43a-6a18-4eb8-99db-64f5bf8191c2" title="Permalink to this equation">#</a></span>\[\begin{align}
J_{AB}(Z_1,Z_2,a,R) &amp;= \left\langle \phi_A \mid -\frac{1}{r_B} \mid \phi_A \right\rangle \\
&amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid -\frac{1}{r_B} \mid 1s_A + a\cdot2p_{zA} \right\rangle \\
&amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A  \mid -\frac{1}{r_B} \mid 1s_A \right\rangle + a\left\langle 1s_A  \mid -\frac{1}{r_B} \mid 2p_{zA} \right\rangle + a\left\langle 2p_{zA}  \mid -\frac{1}{r_B} \mid 1s_A \right\rangle + a^2\left\langle 2p_{zA}  \mid -\frac{1}{r_B} \mid 2p_{zA} \right\rangle\right] \\
&amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A  \mid -\frac{1}{r_B} \mid 1s_A \right\rangle + 2a\left\langle 1s_A  \mid -\frac{1}{r_B} \mid 2p_{zA} \right\rangle + a^2\left\langle 2p_{zA}  \mid -\frac{1}{r_B} \mid 2p_{zA} \right\rangle\right] \\
&amp;= \frac{J_{1s-1s}(Z1,R) + 2aJ_{1s-2p}(Z1,Z2,R) + a^2J_{2p-2p}(Z2,R)}{1+a^2}
\end{align}\]</div>
<p><br />
Note that from <span class="math notranslate nohighlight">\(J_{AB}\)</span>, we derive three distinct coulomb, or <span class="math notranslate nohighlight">\(J\)</span> functions, one for each distinct orbital combination (<span class="math notranslate nohighlight">\(1s\)</span> with <span class="math notranslate nohighlight">\(1s\)</span>, <span class="math notranslate nohighlight">\(1s\)</span> with <span class="math notranslate nohighlight">\(2p_z\)</span>, and <span class="math notranslate nohighlight">\(2p_z\)</span> with <span class="math notranslate nohighlight">\(2p_z\)</span>). Each coulomb integral’s functional form can be found in the aforementioned table later, or in the hidden code directly below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">J_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="n">w</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">I7</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">I8</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">I5</span><span class="o">*</span><span class="n">I2</span> <span class="o">+</span> <span class="p">(</span><span class="n">I1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I3</span><span class="p">)</span><span class="o">*</span><span class="n">I6</span> <span class="o">+</span> <span class="n">I7</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I2</span><span class="p">)</span> <span class="o">+</span> <span class="n">I3</span><span class="o">*</span><span class="n">I8</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
    <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">I2</span><span class="o">*</span><span class="n">I4</span> <span class="o">+</span> <span class="p">(</span><span class="n">I1</span><span class="o">+</span><span class="n">I3</span><span class="p">)</span><span class="o">*</span><span class="n">I5</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="n">I6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">J_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">J_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">J_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>As with our <span class="math notranslate nohighlight">\(S\)</span> integrals, it is useful to plot the <span class="math notranslate nohighlight">\(J\)</span> integral functions to see if each function behaves appropriately as written. For these integrals, the main features we will consider are end behavior (values for R near bonding distance, zero, and infite separation).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">J_1s_basis</span> <span class="o">=</span> <span class="n">J_1s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">J_2p_basis</span> <span class="o">=</span> <span class="n">J_2p</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">J_1s_2p_basis</span> <span class="o">=</span> <span class="n">J_1s_2p</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">J_combined</span> <span class="o">=</span> <span class="n">J_AB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">J_1s_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;J - 1s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">J_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;J - 2pz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">J_1s_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;J - 1s-2pz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">J_combined</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$J_</span><span class="si">{AB}</span><span class="s1">$ (a=1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;J for H$_2^+$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/fadbe6d9161111565bc9f53c15e6c0d9ab1287ab01cab151255fa7382a4edde3.png" src="../../_images/fadbe6d9161111565bc9f53c15e6c0d9ab1287ab01cab151255fa7382a4edde3.png" />
</div>
</div>
<p>Here, we see that each function seems to approach zero at infinite separation, intuitive since coulombic interactions decay exponentially as separation distance increases. Near zero, each function approaches a finite value. <br />
<br />
Next, we will consider <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle\)</span>.</p>
</section>
</section>
<section id="left-langle-phi-a-mid-hat-h-mid-phi-b-right-rangle">
<h3><span class="section-number">4.5.19.7.3. </span><span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle\)</span>.<a class="headerlink" href="#left-langle-phi-a-mid-hat-h-mid-phi-b-right-rangle" title="Permalink to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-aa19ee35-5991-4f94-b48f-9797245b39c2">
<span class="eqno">(4.971)<a class="headerlink" href="#equation-aa19ee35-5991-4f94-b48f-9797245b39c2" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle &amp;= \left\langle \phi_A \mid -\frac{1}{2}\nabla^2 \mid \phi_B \right\rangle + \left\langle \phi_A \mid -\frac{1}{r_A} \mid \phi_B \right\rangle + \left\langle \phi_A \mid -\frac{1}{r_B} \mid \phi_B \right\rangle + \left\langle \phi_A \mid \frac{1}{R} \mid \phi_B \right\rangle \\
 &amp;= T_{AB}(Z_1,Z_2,a,R) + 2K_{AB}(Z_1,Z_2,a,R)  + \frac{S(Z_1,Z_2,a,R)}{R}
\end{align}\]</div>
<p><br />
For this section of calculations, we will tackle <span class="math notranslate nohighlight">\(K_{AB}\)</span> first, as it will allow us to identify simplifications in the <span class="math notranslate nohighlight">\(T_{AB}\)</span> calculations.</p>
<section id="k-ab-z-1-z-2-a-r">
<h4><span class="section-number">4.5.19.7.3.1. </span><span class="math notranslate nohighlight">\(K_{AB}(Z_1,Z_2,a,R)\)</span><a class="headerlink" href="#k-ab-z-1-z-2-a-r" title="Permalink to this heading">#</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-bdc4dd1d-7157-4812-ade0-193a00d64468">
<span class="eqno">(4.972)<a class="headerlink" href="#equation-bdc4dd1d-7157-4812-ade0-193a00d64468" title="Permalink to this equation">#</a></span>\[\begin{align}
K_{AB}(Z1,Z2,a,R) &amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid -\frac{1}{r_B} \mid 1s_B+ a\cdot2p_{zB} \right\rangle \\
 &amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A \mid -\frac{1}{r_B} \mid 1s_B \right\rangle + a\left\langle 1s_A  \mid -\frac{1}{r_B} \mid 2p_{zB} \right\rangle + a\left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 1s_B \right\rangle + a^2\left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 2p_{zB} \right\rangle\right] \\
  &amp;= \frac{1}{1+a^2}\left[ K_{1s-1s}(Z_1,R) + aK_{2p-1s}(Z_1,Z_2,R) + aK_{1s-2p}(Z_1,Z_2,R) + a^2K_{2p-2p}(Z_2,R)\right] \\
  &amp;= \frac{1}{1+a^2}\left[ K_{1s-1s}(Z_1,R) + a\left(K_{2p-1s}(Z_1,Z_2,R) + K_{1s-2p}(Z_1,Z_2,R)\right) + a^2K_{2p-2p}(Z_2,R)\right] \\
\end{align}\]</div>
<p><br />
Note that the exchange functions (<span class="math notranslate nohighlight">\(K\)</span>) come out of the <span class="math notranslate nohighlight">\(K_{AB}\)</span> calculations, where orbitals on opposite nuclei are subject to the <span class="math notranslate nohighlight">\(-1/r_A\)</span> or <span class="math notranslate nohighlight">\(-1/r_B\)</span> operators. The functional forms of all exchange integrals can be found in the aforementioned table, or in the code cell directly below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">THRESH</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="k">def</span> <span class="nf">K_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">K_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="n">I5</span><span class="o">*</span><span class="p">(</span><span class="n">I1</span><span class="o">+</span><span class="n">I3</span><span class="p">)</span> <span class="o">-</span> <span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span><span class="o">+</span><span class="n">I6</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="n">I5</span><span class="o">*</span><span class="p">(</span><span class="n">I1</span><span class="o">-</span><span class="n">I3</span><span class="p">)</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span><span class="o">-</span><span class="n">I6</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">K_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">K_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Once again, it is prudent to plot our notable functions (in this case the exchange functions) to determine if anything seems incorrect offhand. Since we do not cover the exchange function behavior in great detail, it will suffice to check for appropriate end behavior.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">K_1s_basis</span> <span class="o">=</span> <span class="n">K_1s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">K_2p_basis</span> <span class="o">=</span> <span class="n">K_2p</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">K_1s_2p_basis</span> <span class="o">=</span> <span class="n">K_1s_2p</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">K_2p_1s_basis</span> <span class="o">=</span> <span class="n">K_2p_1s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">K_combined</span> <span class="o">=</span> <span class="n">K_AB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">K_1s_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;K - 1s-1s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">K_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;K - 2p-2p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">K_1s_2p_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;K - 1s-2p&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">K_2p_1s_basis</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;K - 2p-1s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">K_combined</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;K$_</span><span class="si">{AB}</span><span class="s1">$ - a=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;K for H$_2^+$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e7c47dadfeb65244c1033713f1336f64af6ec7e64c7a90e60ab4a2199514bc45.png" src="../../_images/e7c47dadfeb65244c1033713f1336f64af6ec7e64c7a90e60ab4a2199514bc45.png" />
</div>
</div>
<p>After plotting, everything seems in order given that each exchange function approaches a finite value at bonding distance, and zero at infinite separation. <br />
<br />
Next, we will look at <span class="math notranslate nohighlight">\(T_{AB}\)</span>, which will call upon the <span class="math notranslate nohighlight">\(K\)</span> function we have established, so it is good we already checked them and nested them in our code.</p>
</section>
<section id="t-ab-z1-z2-a-r">
<h4><span class="section-number">4.5.19.7.3.2. </span><span class="math notranslate nohighlight">\(T_{AB}(Z1,Z2,a,R)\)</span><a class="headerlink" href="#t-ab-z1-z2-a-r" title="Permalink to this heading">#</a></h4>
<div class="amsmath math notranslate nohighlight" id="equation-4db7cade-8cf2-4b25-9755-7ba2f56ae16d">
<span class="eqno">(4.973)<a class="headerlink" href="#equation-4db7cade-8cf2-4b25-9755-7ba2f56ae16d" title="Permalink to this equation">#</a></span>\[\begin{align}
T_{AB}(Z1,Z2,a,R) &amp;= \frac{1}{1+a^2}\left\langle 1s_A + a\cdot2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 1s_B+ a\cdot2p_{zB} \right\rangle \\
 &amp;= \frac{1}{1+a^2}\left[ \left\langle 1s_A \mid -\frac{1}{2}\nabla^2 \mid 1s_B \right\rangle + a\left\langle 1s_A  \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle + a\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 1s_B \right\rangle + a^2\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle\right]
\end{align}\]</div>
<p><br />
We will work out the first of these to show how familiar functional forms pop out. Note specifically how we can use the operation of the kinetic energy operator on the <span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_z\)</span> orbital functions we calculated earlier (see <span class="math notranslate nohighlight">\(T_{AA}\)</span>) to hasten this calculation and reduce it to familiar forms.</p>
<div class="amsmath math notranslate nohighlight" id="equation-b481bae8-cf98-40fa-85a0-33f3be3c4251">
<span class="eqno">(4.974)<a class="headerlink" href="#equation-b481bae8-cf98-40fa-85a0-33f3be3c4251" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 1s_A \mid -\frac{1}{2}\nabla^2 \mid 1s_B \right\rangle &amp;= \left( \frac{Z_1^3}{\pi}\right) \int_{\text{all space}} e^{-Z_1r_A}\left(-\frac{1}{2}\nabla^2 \right) e^{-Z_1r_B}  d\vec{r} \\
&amp;= \left( \frac{Z_1^3}{\pi}\right) \int_{\text{all space}} e^{-Z_1r_A}\left(\frac{Z_1}{r_B} - \frac{Z_1^2}{2}\right)e^{-Z_1r_B}  d\vec{r} \\
&amp;= \left( \frac{Z_1^3}{\pi}\right) \left[ Z_1\int_{\text{all space}} \frac{e^{-Z_1(r_A+r_B)}}{r_B}d\vec{r} - \frac{Z_1^2}{2}\int_{\text{all space}} e^{-Z_1(r_A+r_B)}d\vec{r}  \right] \\
&amp;= \left( \frac{Z_1^3}{\pi}\right) \left[ (Z_1)\frac{\pi}{Z_1^2}e^{-Z_1R}\left(Z_1R+1\right) - \frac{Z_1^2}{2}\frac{\pi e^{-Z_1R}}{3Z_1^3}\left(2Z_1^2R^2 + 3Z_1R + 3\right)  \right] \\
&amp;= Z_1^2e^{-Z_1R}\left[ \frac{(Z_1)}{Z_1}\left(Z_1R+1\right) - \frac{1}{6}\left(2Z_1^2R^2 + 3Z_1R + 3\right)  \right] \\
&amp;= -Z_1K_{1s-1s}-\frac{Z_1^2}{2}S_{1s-1s} \\
&amp;= -Z_1\left(K_{1s-1s}+\frac{Z_1}{2}S_{1s-1s}\right)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\left\langle 1s_A \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle\)</span> Takes a similar form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4bd895d8-fd89-4781-8917-ff38f3382e6e">
<span class="eqno">(4.975)<a class="headerlink" href="#equation-4bd895d8-fd89-4781-8917-ff38f3382e6e" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 1s_A \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle &amp;= -Z_2\left(2K_{2pz-1s} + \frac{Z_2}{2}S_{1s-2pz} \right)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 1s_B \right\rangle\)</span> Takes a similar form as well:</p>
<div class="amsmath math notranslate nohighlight" id="equation-95ebf41d-b96b-4d09-bb54-56ab30afe0d8">
<span class="eqno">(4.976)<a class="headerlink" href="#equation-95ebf41d-b96b-4d09-bb54-56ab30afe0d8" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 2p_{zA}\mid -\frac{1}{2}\nabla^2 \mid 1s_B \right\rangle &amp;= -Z_1\left( K_{1s-2pz}+\frac{Z_1}{2}S_{2pz-1s} \right)
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle\)</span> Takes a similar form as well:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e5083456-5d7d-4f88-81fc-1bf306304d2d">
<span class="eqno">(4.977)<a class="headerlink" href="#equation-e5083456-5d7d-4f88-81fc-1bf306304d2d" title="Permalink to this equation">#</a></span>\[\begin{align}
\left\langle 2p_{zA} \mid -\frac{1}{2}\nabla^2 \mid 2p_{zB} \right\rangle &amp;
&amp;= -Z_2\left(2K_{2pz-2pz} + \frac{Z_2}{2}S_{2pz-2pz}\right)
\end{align}\]</div>
<p>Thus:</p>
<div class="amsmath math notranslate nohighlight" id="equation-65e3b85f-ed49-4478-ac72-828b292839b4">
<span class="eqno">(4.978)<a class="headerlink" href="#equation-65e3b85f-ed49-4478-ac72-828b292839b4" title="Permalink to this equation">#</a></span>\[\begin{align}
T_{AB}(Z1,Z2,a,R) &amp;= \frac{1}{1+a^2}\left[ -Z_1\left(K_{1s-1s}+\frac{Z_1}{2}S_{1s-1s}\right) -aZ_2\left(2K_{2pz-1s} + \frac{Z_2}{2}S_{1s-2pz} \right) -aZ_1\left( K_{1s-2pz}+\frac{Z_1}{2}S_{2pz-1s} \right) -a^2Z_2\left(2K_{2pz-2pz} + \frac{Z_2}{2}S_{2pz-2pz}\right)\right] \\
&amp;= \frac{-1}{1+a^2}\left[ Z_1K_{1s-1s} + 2aZ_2K_{2pz-1s} + aZ_1K_{1s-2pz} + a^22Z_2K_{2pz-2pz} + \frac{Z_1^2}{2}S_{1s-1s} + a\frac{Z_2^2}{2}S_{1s-2pz} + a\frac{Z_1^2}{2}S_{2pz-1s}  + a^2\frac{Z_2^2}{2}S_{2pz-2pz}\right]\\
&amp;= \frac{-1}{1+a^2}\left[ Z_1K_{1s-1s} + 2aZ_2K_{2pz-1s} + aZ_1K_{1s-2pz} + 2a^2Z_2K_{2pz-2pz} + \frac{Z_1^2}{2}S_{1s-1s} + \frac{aS_{1s-2pz}}{2} \left(Z_2^2 + Z_1^2\right) + a^2\frac{Z_2^2}{2}S_{2pz-2pz}\right]
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">kterms</span> <span class="o">=</span> <span class="n">Z1</span><span class="o">*</span><span class="n">K_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">*</span><span class="n">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">Z1</span><span class="o">*</span><span class="n">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">*</span><span class="n">K_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
    <span class="n">sterms</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">Z1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Z1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">prefactor</span><span class="o">*</span><span class="p">(</span><span class="n">kterms</span><span class="o">+</span><span class="n">sterms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="overlap-coulomb-and-exchange-functions">
<h2><span class="section-number">4.5.19.8. </span>Overlap, Coulomb, and Exchange Functions<a class="headerlink" href="#overlap-coulomb-and-exchange-functions" title="Permalink to this heading">#</a></h2>
<p>Before we get into compiling the total energy function, you have been promised a table outlining the functional forms of our <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(J\)</span>, and <span class="math notranslate nohighlight">\(K\)</span>, integrals/functions.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Function</p></th>
<th class="head text-left"><p>Integral</p></th>
<th class="head text-left"><p>Solution in H<span class="math notranslate nohighlight">\(_2^+\)</span> Polarized Basis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(S_{1s}(Z_1,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid \ 1s_B \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = e^{-Z_1R}(1 + Z_1R + \frac{Z_1^2R^2}{3})\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(S_{2p}(Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\left\langle 2p_{zA} \mid 2p_{zB} \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = \frac{-Z_2R}{15}(Z_2^4R^4 + 2Z_2^3R^3 - 3Z_2^2R^2 - 15Z_2R - 15)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(S_{1s-2p}(Z_1,Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid 2p_{zB} \right\rangle = \left\langle 2p_{zA} \mid 1s_B \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = \frac{Z_1^{1.5}Z_2^{2.5}R^4}{8}(I_1I_7 + I_2I_8 - I_3I_5 - I_4I_6)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(J_{1s}(Z_1,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid -\frac{1}{r_B} \mid  1s_A \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = Z_1(e^{-2Z_1R}(1+\frac{1}{Z_2R}) - \frac{1}{Z_1R})\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(J_{2p}(Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 2p_{zA} \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = \frac{-Z_2^5R^4}{8}(L_5L_2 + (L_1 + 2L_3)L_6 + L_7(L_4 + 2L_2) + L_3L_8)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(J_{1s-2p}(Z_1,Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid \frac{1}{r_B} \mid 2p_{zA} \right\rangle = \left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 1s_A \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(= -0.25Z_1^{1.5}Z_2^{2.5}R^3(M_2M_4 + (M_1+M_3)M_5 + M_2M_6)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(K_{1s}(Z_1, R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid -\frac{1}{r_B} \mid  1s_B \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = -Z_1e^{-Z_1R}(1+Z_1R)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(K_{2p}(Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 2p_{zB} \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(= \frac{-Z_2^5R^4}{8}(2N_1 - \frac{2}{3}N_2)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(K_{1s-2p}(Z_1,Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 1s_A \mid \frac{1}{r_B} \mid 2p_{zA} \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = -0.25Z_1^{1.5}Z_2^{2.5}R^3(P_5(P_1-P_3) + P_2(P_4-P_6))\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(K_{2p-1s}(Z_1,Z_2,R)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( \left\langle 2p_{zA} \mid -\frac{1}{r_B} \mid 1s_A \right\rangle\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\( = -0.25Z_1^{1.5}Z_2^{2.5}R^3(P_5(P_1+P_3) - P_2(P_4+P_6))\)</span></p></td>
</tr>
</tbody>
</table>
<p>Where values for all I, L, M, N, O, and P functions can be found in the Appendix at the end of this section.</p>
</section>
<section id="total-energy">
<h2><span class="section-number">4.5.19.9. </span>Total Energy<a class="headerlink" href="#total-energy" title="Permalink to this heading">#</a></h2>
<p>Now the total energy combining all of the above is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-56fd9d13-3b9e-43db-9131-53996f601f44">
<span class="eqno">(4.979)<a class="headerlink" href="#equation-56fd9d13-3b9e-43db-9131-53996f601f44" title="Permalink to this equation">#</a></span>\[\begin{align}
E_{\psi_+} &amp;=  \frac{1}{(1+S_{AB})}\left[ \left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle + \left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle \right] \\
&amp;= \frac{T_{AA}(Z_1,Z_2,a) + J_{AA}(Z_1,Z_2,a) + J_{AB}(Z_1,Z_2,a,R) + \frac{1}{R} + T_{AB}(Z_1,Z_2,a,R) + 2K_{AB}(Z_1,Z_2,a,R)  + \frac{S(Z_1,Z_2,a,R)}{R}}{(1+S_{AB}(Z_1,Z_2,a,R))} \\
&amp;= \frac{T_{AA}(Z_1,Z_2,a) + J_{AA}(Z_1,Z_2,a) + J_{AB}(Z_1,Z_2,a,R) + T_{AB}(Z_1,Z_2,a,R) + 2K_{AB}(Z_1,Z_2,a,R)  }{(1+S_{AB}(Z_1,Z_2,a,R))} + \frac{1}{R}
\end{align}\]</div>
<p><br />
<br />
And there you have it! Since we have already defined the functions called on by the monster of an equation above, we need only to define our variational parameters and return expectation values. To explore the code to do this, see the hidden cells below. If you do, you should note how simple the equation seems in the code for now, since it seems to consist of only a few lines of code (remember that each of the functions it calls is comprised of more functions). Later, we will compile all of the nested, pre-defined functions to one code cell which you will observe is much more robust. <br />
<br />
The first plot we will make to visualize our results simply assigns all of our variational parameters a discrete value, then plots the energy as a function of <span class="math notranslate nohighlight">\(R\)</span>. For reference, <span class="math notranslate nohighlight">\(Z_1=1.0\)</span> and <span class="math notranslate nohighlight">\(Z_2=0.5\)</span> for each depicted choice of <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">E_1s_2p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">E_1s_2p_basis_a_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">E_1s_2p_basis_a_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">E_1s_2p_basis_a_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">E_1s_2p_basis_a_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_1s_2p</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>
    <span class="n">E_1s_2p_basis_a_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_1s_2p</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>
    <span class="n">E_1s_2p_basis_a_100</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_1s_2p</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_a_0</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s-2pz a=0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_a_1</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s-2pz a=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_a_100</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s-2pz a=100&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Variational Solution to the H$_2^+$ Molecule in Polarized Slater Basis&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f8182c161c0181df4a5eb56ac5f5f20bc6fef803f6f384991d386a34f46d0451.png" src="../../_images/f8182c161c0181df4a5eb56ac5f5f20bc6fef803f6f384991d386a34f46d0451.png" />
</div>
</div>
<p>Compare this plot to those produced for the LCAO and Slater bases, do any of the plotted curves look familiar (hint: look closely at the blue curve for <span class="math notranslate nohighlight">\(a=0\)</span>, and remember the <span class="math notranslate nohighlight">\(Z\)</span> values we set)?</p>
<p>Next, we will write a code to optimize each of our variational parameters at many values of <span class="math notranslate nohighlight">\(R\)</span>. This is the most important plot we have made so far, as it will show us whether we achieved an energy function that improves upon the LCAO and Slater bases.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">E_1s_2p_basis_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">min_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">min_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E_1s_2p</span><span class="p">,</span><span class="n">guess</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span>
    <span class="n">E_1s_2p_basis_opt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_1s_2p</span><span class="p">(</span><span class="n">min_params</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="n">min_params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_opt</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s-2pz opt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Variational Solution to the H$_2^+$ Molecule in Polarized Slater Basis&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/295f40dafba00eb1b969edf06189bd3d3fec16a18ee74954ebf5a9db4feba0c4.png" src="../../_images/295f40dafba00eb1b969edf06189bd3d3fec16a18ee74954ebf5a9db4feba0c4.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="k">def</span> <span class="nf">E_1s_2p_to_minimize</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>


<span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">min_param</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E_1s_2p_to_minimize</span><span class="p">,</span><span class="n">guess</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Energy of H2+ in 1s-2p polarized basis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Rmin = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">min_param</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Emin = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">E_1s_2p_to_minimize</span><span class="p">(</span><span class="n">min_param</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimum Energy of H2+ in 1s-2p polarized basis:
	 Rmin =  1.9712
	 Emin =  -0.5976
</pre></div>
</div>
</div>
</div>
<p>Minimum Energy of <span class="math notranslate nohighlight">\(H_2^+\)</span> in <span class="math notranslate nohighlight">\(1s-2p\)</span> polarized basis:
<span class="math notranslate nohighlight">\(R_{min}\)</span> =  1.9712
<span class="math notranslate nohighlight">\(E_{min}\)</span> =  -0.5976
From the graph and determined minima, we can see this model improves upon the LCAO and Slater bases by decreasing both the energy and nuclear separation of bonding in the <span class="math notranslate nohighlight">\(H_2^+\)</span> cation. <br />
<br />
As mentioned in the basis set enumeration, we expect <span class="math notranslate nohighlight">\(Z_1\)</span> and <span class="math notranslate nohighlight">\(Z_2\)</span> to differ, and <span class="math notranslate nohighlight">\(a\)</span> to change as the nuclear separation decreases. Let us plot the optimized values of <span class="math notranslate nohighlight">\(Z_1\)</span>, <span class="math notranslate nohighlight">\(Z_2\)</span>, and <span class="math notranslate nohighlight">\(a\)</span> at different values of <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fiz</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">min_params</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Z_1$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">min_params</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Z_2$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.75</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Z$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">min_params</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c3baca8f631cd2550832b9021d40dfe478e7fac6132f97591607fa61edc79195.png" src="../../_images/c3baca8f631cd2550832b9021d40dfe478e7fac6132f97591607fa61edc79195.png" />
</div>
</div>
<p>Our expectations hold true! It is very apparent, especially for the important range for energy considerations, that <span class="math notranslate nohighlight">\(Z_{1min}\)</span> and <span class="math notranslate nohighlight">\(Z_{2 min}\)</span> take differing values, which means it was worthwhile after all to note them as separate variational parameters. Additionally, <span class="math notranslate nohighlight">\(a_{min}\)</span> increases significantly near bond distance, and falls to zero as the nuclei reach infinite separation. The observed relationship between <span class="math notranslate nohighlight">\(a\)</span> (recall, this is our parameter to weight p-orbital contribution) and nuclear separation is intuitive given what we know thus far about the polarization function contribution. Specifically, the LCAO and Slater bases already do an excellent job approximating the system’s behavior at infinite separation (recall, infinite separation gives one hydrogen atom which can be modeled very well by Slater, and one hydrogen ion which does not contribute energetically to our model). Thus, polarization functions are unnecessary at infinite separation, and <span class="math notranslate nohighlight">\(a\)</span> should (and upon calculation, does) fall to zero. Conversely, the central idea of adding polarization functions is to account for something we were missing near bond distance when modeling using LCAO and SLater. Since we see that the polarization basis provides a better energy estimate, it makes sense that <span class="math notranslate nohighlight">\(a\)</span> should take on non-zero values near bond distance.</p>
</section>
<section id="combining-the-code">
<h2><span class="section-number">4.5.19.10. </span>Combining the Code<a class="headerlink" href="#combining-the-code" title="Permalink to this heading">#</a></h2>
<p>As mentioned earlier, the final code cell for the energy function developed for the polarized basis set seems uncharacteristically simple on its own. Below you can find the code for all of the functions we have defined so far, nested together such that only that cell needs to be run to call upon any or all of them. <br />
<br />
A few important notes about the all-in-one code cell:</p>
<ol class="arabic simple">
<li><p>Inactive text is embedded in the cell by starting a new line with “#”. This function was utilized for organization and to leave personal notes for orientation to the code developed along the way. These are particularly useful to translate between naming systems and seeing where functions are defined to be nested within others.</p></li>
<li><p>Some of the functions appear in a different order than they do in the notes above. The notebook has been organized such that the code cells can be run from top to bottom individually, which requires that any nested functions in a new cell be pre-defined and run in an earlier cell. This limitation does not apply in the same way for functions called from a single cell, so this is organized to represent the order in which the code was originally written.</p></li>
<li><p>Several libraries and specific tools from those libraries are imported at the beginning of the cell, then sometimes again later. Any second importing of a library or tool is redundant, but was left in to show if a certain portion of the code calls upon that library/tool (similar for some variables, like THRESH).</p></li>
<li><p>At the bottom of the cell, there is a note regarding the input of plotting code. Any/all of the plots depicted above can be generated using the all-in-one cell simply by pasting the code for an individual plot below the note. If you are interested in the coding process, try generating some of the plots, manipulate them to show different relationships and new insights (e.g. what happens to the non-optimized polarized energy plot when you change the assigned values of <span class="math notranslate nohighlight">\(Z_1\)</span>, <span class="math notranslate nohighlight">\(Z_2\)</span>, and <span class="math notranslate nohighlight">\(a\)</span>?).</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Welcome to the function definition, all-in-one cell. You can also think of this as your &quot;all in one&quot; cell.</span>
<span class="c1">#In this cell, all of the functions we need to define E_1s_2p are defined and nested with notes about where they come from and fit in.#</span>
<span class="c1">#Running this cell unchanged simply prints the minimum Energy and R that gives that energy.#</span>
<span class="c1">#At the bottom of this cell, you can input any/all plot codes from the plotting code cell to visualize the values of each function at given R values.#</span>

<span class="c1">#Start with importing a bunch of libraries just in case specific lines below do not call them#</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span><span class="p">,</span> <span class="n">colors</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_genlaguerre</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">lpmv</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>


<span class="c1">#Start with &lt;PsiA|H|PsiA&gt; = T_AA + J_AA + J_AB + 1/R#</span>
<span class="c1">#write a note without changing the code</span>
<span class="k">def</span> <span class="nf">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">):</span> <span class="c1">#Was KE_AA#</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Z1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">Z1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Need to nest functions for J_AB = &lt;PsiA|-1/rB|PsiA&gt;#</span>

<span class="k">def</span> <span class="nf">J_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">Z</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">w</span><span class="p">))</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="n">w</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">I7</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">I8</span> <span class="o">=</span> <span class="n">I5</span><span class="o">/</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">I5</span><span class="o">*</span><span class="n">I2</span> <span class="o">+</span> <span class="p">(</span><span class="n">I1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I3</span><span class="p">)</span><span class="o">*</span><span class="n">I6</span> <span class="o">+</span> <span class="n">I7</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I2</span><span class="p">)</span> <span class="o">+</span> <span class="n">I3</span><span class="o">*</span><span class="n">I8</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
    <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">I2</span><span class="o">*</span><span class="n">I4</span> <span class="o">+</span> <span class="p">(</span><span class="n">I1</span><span class="o">+</span><span class="n">I3</span><span class="p">)</span><span class="o">*</span><span class="n">I5</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="n">I6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">J_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">J_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">J_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Done with function nesting for &lt;PsiA|H|PsiA&gt;, will call these functions at the end#</span>

<span class="c1">#Now, work on &lt;PsiA|H|PsiB&gt; = T_AB + 2*K_AB + S_AB/R#</span>

<span class="k">def</span> <span class="nf">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span> <span class="c1">#Was KE_AB#</span>
    <span class="n">prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">kterms</span> <span class="o">=</span> <span class="n">Z1</span><span class="o">*</span><span class="n">K_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">*</span><span class="n">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">Z1</span><span class="o">*</span><span class="n">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">*</span><span class="n">K_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
    <span class="n">sterms</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">Z1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Z1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">prefactor</span><span class="o">*</span><span class="p">(</span><span class="n">kterms</span><span class="o">+</span><span class="n">sterms</span><span class="p">)</span>

<span class="c1">#Need to nest functions for K_AB#</span>

<span class="n">THRESH</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="k">def</span> <span class="nf">K_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">K_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="n">I1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
    <span class="n">I2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">I2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="n">I5</span><span class="o">*</span><span class="p">(</span><span class="n">I1</span><span class="o">+</span><span class="n">I3</span><span class="p">)</span> <span class="o">-</span> <span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span><span class="o">+</span><span class="n">I6</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z1</span><span class="o">-</span><span class="n">Z2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I4</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.25</span><span class="o">*</span><span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span> <span class="n">I5</span><span class="o">*</span><span class="p">(</span><span class="n">I1</span><span class="o">-</span><span class="n">I3</span><span class="p">)</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="p">(</span><span class="n">I4</span><span class="o">-</span><span class="n">I6</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">K_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">K_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">K_2p_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">K_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Done with function nesting for &lt;PsiA|H|PsiB&gt;, will call these functions at the end#</span>

<span class="c1">#Now, work on &lt;PsiA|PsiB&gt; = prefactor * [S_1s + 2*a*S_1s_2p + a**2*S_2p]#</span>

<span class="n">THRESH</span> <span class="o">=</span> <span class="mf">1e-8</span>

<span class="k">def</span> <span class="nf">S_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">w</span> <span class="o">+</span> <span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I7</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I8</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">I1</span><span class="o">*</span><span class="n">I7</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="n">I8</span> <span class="o">-</span> <span class="n">I3</span><span class="o">*</span><span class="n">I5</span> <span class="o">-</span> <span class="n">I4</span><span class="o">*</span><span class="n">I6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">S_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Done with nesting functions for &lt;PsiA|PsiB&gt;, will call these functions in the end#</span>

<span class="c1">#Time to call our nested functions and combine them to define the energy function, E_1s_2p#</span>

<span class="k">def</span> <span class="nf">E_1s_2p</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>

<span class="c1">#Done with defining our energy function, now let&#39;s minimize#</span>

<span class="k">def</span> <span class="nf">E_1s_2p_to_minimize</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">T_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AA</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">J_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">T_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">K_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>


<span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">min_param</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E_1s_2p_to_minimize</span><span class="p">,</span><span class="n">guess</span><span class="p">)</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum Energy of H2+ in 1s-2p polarized basis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Rmin = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">min_param</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> Emin = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">E_1s_2p_to_minimize</span><span class="p">(</span><span class="n">min_param</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>

<span class="c1">#Now, input functions for the other basis sets we have tried so we can compare to the polarization consideration#</span>

<span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>
<span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">R</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">R</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">K</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">T</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">Z</span> <span class="o">+</span> <span class="n">Z</span><span class="o">*</span><span class="n">J</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Z</span><span class="o">*</span><span class="n">K</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V</span>

<span class="n">E_1s_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">Z_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">Z_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">E_1s_opt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">Z_min</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>



<span class="c1">#Input any plot codes below to call any of our defined functions for plotting/visualization#</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimum Energy of H2+ in 1s-2p polarized basis:
	 Rmin =  1.9712
	 Emin =  -0.5976
</pre></div>
</div>
</div>
</div>
</section>
<section id="graphed-comparisons-of-polarization-to-lcao-and-slater-bases">
<h2><span class="section-number">4.5.19.11. </span>Graphed comparisons of Polarization to LCAO and Slater bases<a class="headerlink" href="#graphed-comparisons-of-polarization-to-lcao-and-slater-bases" title="Permalink to this heading">#</a></h2>
<p>While comparing the expected bond distances and minimum energy values between bases is a useful endeavor, we can gleam additional insight by plotting the energy curves for each basis set and visually comparing. To do so, we will call upon older code which will allow us to define the LCAO and Slater energy functions alongside the newly-developed polarization function.</p>
<section id="energy-plots">
<h3><span class="section-number">4.5.19.11.1. </span>Energy Plots<a class="headerlink" href="#energy-plots" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">R</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">R</span>
<span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">R</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">R</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">K</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">T</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">Z</span> <span class="o">+</span> <span class="n">Z</span><span class="o">*</span><span class="n">J</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Z</span><span class="o">*</span><span class="n">K</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">/=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S</span><span class="p">(</span><span class="n">Z</span><span class="o">*</span><span class="n">R</span><span class="p">))</span>
    <span class="n">V</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V</span>

<span class="n">E_1s_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">Z_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">Z_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">E_1s_opt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">Z_min</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_a_0</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_opt</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s opt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">E_1s_2p_basis_opt</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;E - 1s-2pz opt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;R/$a_0$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_0 (Hartree)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.6,-0.1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Variational Solution to the H$_2^+$ Molecule in Polarized Slater Basis&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/27d3eed9b962ed100e2dbfed694b5dd83e4b09a7172641e14a236b86121c1924.png" src="../../_images/27d3eed9b962ed100e2dbfed694b5dd83e4b09a7172641e14a236b86121c1924.png" />
</div>
</div>
<p>This is our final, and overall most important plot concerning the energy functions of the basis sets we have worked through. Note the features we have already described: lower minimum energy and bond distance. From these features, we can readily establish that the polarization model is a better approximation of the real physical nature of molecular bonding. The other major feature of this plot is how the energy of the polarized model delineates from the -0.5 Hartree expected of the <span class="math notranslate nohighlight">\(H^+\)</span> <span class="math notranslate nohighlight">\(+\)</span> <span class="math notranslate nohighlight">\(H\)</span> system at a larger nuclear separation than either the LCAO or Slater, which largely track together until much closer to the estimated bond distance. This feature indicates more significant interactions between nuclei at larger separation, and is introduced by the ability of the polarized basis set to account for non-spherically symmetric orbital densities which “stretch” from one nucleus towards the other. In the LCAO or Slater bases, this “stretching” could only be achieved by increasing the diffusivity of the overall orbital outside of reasonable limits. <br />
<br />
To visualize the discussion of orbitals, let us take a look at the wavefunctions of <span class="math notranslate nohighlight">\(1s\)</span>, <span class="math notranslate nohighlight">\(2p_z\)</span> and the combined <span class="math notranslate nohighlight">\(1s-2p_z\)</span> developed for this model. Then, we will plot orbital densities for the LCAO, Slater, and Polarized basis sets.</p>
</section>
<section id="orbital-densities">
<h3><span class="section-number">4.5.19.11.2. </span>Orbital Densities<a class="headerlink" href="#orbital-densities" title="Permalink to this heading">#</a></h3>
<p>First, we wil define our wavefunctions and visualize them by plotting each individual (<span class="math notranslate nohighlight">\(1s\)</span> and <span class="math notranslate nohighlight">\(2p_z\)</span>) and the overall polarized wavefunction.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#That is all the code for our energy minimization, now let&#39;s move on to the wavefunction and orbital density code#</span>

<span class="c1">#Start with importing a bunch of libraries just in case specific lines below do not call them#</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span><span class="p">,</span> <span class="n">colors</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_genlaguerre</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">lpmv</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="c1">#Start with defining the wavefunction with the polarized basis set#</span>

<span class="c1">#We will need the S functions from our energy minimization code#</span>

<span class="n">THRESH</span> <span class="o">=</span> <span class="mf">1e-8</span>

<span class="k">def</span> <span class="nf">S_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">w</span> <span class="o">+</span> <span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_2p</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span><span class="n">R</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span><span class="o">*</span><span class="n">R</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Z2</span><span class="o">-</span><span class="n">Z1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">THRESH</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">I1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">I2</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="n">I3</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
        <span class="n">I4</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">I5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I6</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span>
    <span class="n">I7</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">I8</span> <span class="o">=</span> <span class="n">I5</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span> <span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="n">alpha</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="n">Z1</span><span class="o">**</span><span class="mf">1.5</span><span class="o">*</span><span class="n">Z2</span><span class="o">**</span><span class="mf">2.5</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">I1</span><span class="o">*</span><span class="n">I7</span> <span class="o">+</span> <span class="n">I2</span><span class="o">*</span><span class="n">I8</span> <span class="o">-</span> <span class="n">I3</span><span class="o">*</span><span class="n">I5</span> <span class="o">-</span> <span class="n">I4</span><span class="o">*</span><span class="n">I6</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">S_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">S_2p</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">S_1s_2p</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="c1">#First are the 1s and 2pz functions#</span>
<span class="k">def</span> <span class="nf">phi_1s</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">phi_2pz</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">cos_theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">cos_theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>

<span class="c1">#</span>
<span class="k">def</span> <span class="nf">h2_plus_polarized_psi2</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="c1"># position of nuclei are along z-axis equidistant from the origin</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">R</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1"># determine A-dependent separation distance and angle</span>
    <span class="n">rA</span> <span class="o">=</span> <span class="n">r</span><span class="o">-</span><span class="n">RA</span>
    <span class="n">rA_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cosThetaA</span> <span class="o">=</span>  <span class="o">-</span><span class="n">rA</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">rA_mag</span> <span class="c1"># the negative is there to make the parity work out</span>
    <span class="c1"># determine B-dependent separation distance and angle</span>
    <span class="n">rB</span> <span class="o">=</span> <span class="n">r</span><span class="o">-</span><span class="n">RB</span>
    <span class="n">rB_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cosThetaB</span> <span class="o">=</span>  <span class="n">rB</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">rB_mag</span>   
    <span class="c1"># calculate psi</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">psiA</span> <span class="o">=</span> <span class="n">phi_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">rA_mag</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">phi_2pz</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">rA_mag</span><span class="p">,</span><span class="n">cosThetaA</span><span class="p">)</span> 
    <span class="n">psiB</span> <span class="o">=</span> <span class="n">phi_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">rB_mag</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">phi_2pz</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">rB_mag</span><span class="p">,</span><span class="n">cosThetaB</span><span class="p">)</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">psiA</span> <span class="o">+</span> <span class="n">psiB</span>
    <span class="c1"># calculate normalized denisty</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">psi</span><span class="o">*</span><span class="n">psi</span>
    <span class="n">psi2</span> <span class="o">/=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">psi2</span> 

<span class="k">def</span> <span class="nf">h2_plus_polarized_psi</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="c1"># position of nuclei are along z-axis equidistant from the origin</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">R</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1"># determine A-dependent separation distance and angle</span>
    <span class="n">rA</span> <span class="o">=</span> <span class="n">r</span><span class="o">-</span><span class="n">RA</span>
    <span class="n">rA_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cosThetaA</span> <span class="o">=</span>  <span class="o">-</span><span class="n">rA</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">rA_mag</span> <span class="c1"># the negative is there to make the parity work out</span>
    <span class="c1"># determine B-dependent separation distance and angle</span>
    <span class="n">rB</span> <span class="o">=</span> <span class="n">r</span><span class="o">-</span><span class="n">RB</span>
    <span class="n">rB_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cosThetaB</span> <span class="o">=</span>  <span class="n">rB</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">rB_mag</span>   
    <span class="c1"># calculate psi</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">psiA</span> <span class="o">=</span> <span class="n">phi_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">rA_mag</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">phi_2pz</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">rA_mag</span><span class="p">,</span><span class="n">cosThetaA</span><span class="p">)</span> 
    <span class="n">psiB</span> <span class="o">=</span> <span class="n">phi_1s</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">rB_mag</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">phi_2pz</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">rB_mag</span><span class="p">,</span><span class="n">cosThetaB</span><span class="p">)</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">psiA</span> <span class="o">+</span> <span class="n">psiB</span>
    <span class="c1"># calculate normalized denisty</span>
    <span class="n">psi</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">S_AB</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">psi</span>

<span class="k">def</span> <span class="nf">plot_polarized_psi2</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">ax_obj</span><span class="p">,</span> <span class="n">vrange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1200</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">h2_plus_polarized_psi2</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">psi2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vrange</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">psi2</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># plot</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;$R=</span><span class="si">{</span><span class="n">R</span><span class="si">}</span><span class="s1">, a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">, Z_1=</span><span class="si">{</span><span class="n">Z1</span><span class="si">}</span><span class="s1">, Z_2=</span><span class="si">{</span><span class="n">Z2</span><span class="si">}</span><span class="s1">$ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax_obj</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">psi2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gnuplot2_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span> <span class="c1">#For regular orbital densities</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">psi2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="c1"># set the limits of the plot to the limits of the data</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>


<span class="k">def</span> <span class="nf">plot_polarized_log_psi2</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">ax_obj</span><span class="p">,</span> <span class="n">vrange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1200</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">h2_plus_polarized_psi2</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">psi2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">vrange</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">psi2</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">psi2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># plot</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;$R=</span><span class="si">{</span><span class="n">R</span><span class="si">}</span><span class="s1">, a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">, Z_1=</span><span class="si">{</span><span class="n">Z1</span><span class="si">}</span><span class="s1">, Z_2=</span><span class="si">{</span><span class="n">Z2</span><span class="si">}</span><span class="s1">$ &#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax_obj</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">psi2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gnuplot2_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span> <span class="c1">#was gnuplot2_r, for log scale orbital densities</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">psi2</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="c1"># set the limits of the plot to the limits of the data</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">plot_polarized_psi</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">ax_obj</span><span class="p">,</span> <span class="n">vrange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1200</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">h2_plus_polarized_psi</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vrange</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">psi</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">psi</span><span class="p">)))</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">vmax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># plot</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">params</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;$R=</span><span class="si">{</span><span class="n">R</span><span class="si">}</span><span class="s1">, a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">, Z_1=</span><span class="si">{</span><span class="n">Z1</span><span class="si">}</span><span class="s1">, Z_2=</span><span class="si">{</span><span class="n">Z2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax_obj</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="c1"># set the limits of the plot to the limits of the data</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
    <span class="n">ax_obj</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot code for visualization of the total wavefunction, 1s contribution, and 2pz contribution#</span>



<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.97</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

<span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">min_params</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E_1s_2p</span><span class="p">,</span><span class="n">guess</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="n">min_params</span>
    <span class="n">plot_polarized_psi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">min_params</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
    <span class="n">Z_min</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plot_polarized_psi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">min_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
    <span class="n">plot_polarized_psi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="n">min_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">100</span><span class="p">]),</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
    

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Total Wavefunction </span><span class="se">\n</span><span class="s2"> $R=8.0, a=0.15, Z_1=1.03, Z_2=0.18$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$1s$ Contribution </span><span class="se">\n</span><span class="s2"> $R=8.0, a=0.0, Z_1=1.03, Z_2=0.0$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$2p_z$ Contribution </span><span class="se">\n</span><span class="s2"> $R=8.0, a=100.0, Z_1=0.0, Z_2=1.03$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/40379369e16f8d7b71c299a33d5f2f38351242fc6aa005ee1a8e9e176a0d7efd.png" src="../../_images/40379369e16f8d7b71c299a33d5f2f38351242fc6aa005ee1a8e9e176a0d7efd.png" />
</div>
</div>
<p>In this figure, the plots on the left show the combined wavefunction, the middle show the <span class="math notranslate nohighlight">\(1s\)</span>, and right show the <span class="math notranslate nohighlight">\(2p_z\)</span>. Notice here that the <span class="math notranslate nohighlight">\(1s\)</span> wavefunction is the primary contributor to the overall wavefunction, especially far from bond distance (what parameter(s) and optimized values corroborate this finding?). As we approach bond distance, the p-character increases, as we see an increase in saturation of the extra-nuclear lobes. Keep in mind the complex character of the overall wavefunction for our discussion of the orbital densities (next). Additionally, notice the shape of the red portion of the p-orbital wavefunction (remember that p-orbitals have lobes of differing parity, here denoted by the red and blue portions of the graph, separated by a node depicted in white), and how it compresses horizontally and stretches vertically as the nuclei approach bond distance.<br />
<br />
For our discussion of orbital densities, we will plot them on a negative log scale to highlight differences. They can be plotted on a linear scale as well. If you are interested in seeing those plots, see the hidden cell code just below (remember to remove the “#” before any line you want to be active).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot code for orbital densities on negative log scale#</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">24</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> 
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.97</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

<span class="n">guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
    <span class="n">min_params</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E_1s_2p</span><span class="p">,</span><span class="n">guess</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="n">min_params</span>
    <span class="n">plot_polarized_log_psi2</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">min_params</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
    <span class="n">Z_min</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plot_polarized_log_psi2</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Z_min</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="mf">1.50</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
    <span class="n">plot_polarized_log_psi2</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">vrange</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0cdd3a695f923f403993104e919b15975e15ba9d7d3cd5103eb4a3e39912ded2.png" src="../../_images/0cdd3a695f923f403993104e919b15975e15ba9d7d3cd5103eb4a3e39912ded2.png" />
</div>
</div>
<p>In this figure, the left-hand set of plots depicts the polarized <span class="math notranslate nohighlight">\(H_2^+\)</span> model, the middle set depicts the Slater model, and the right set depicts the LCAO model (how could you have determined this from only the labels above each individual plot?). Note the characteristics we discussed from the wavefunction plots: the non-spherical distribution of density in the polarized set contrasted against the spherical symmetry of the LCAO and Slater, as well as the vertical stretching of density between nuclei. In three dimensions, the vertical stretching would appear more like a disc of electron density centered about a point directly between the nuclei. Since we have established that the polarized set gives a better energy and bond distance estimation for <span class="math notranslate nohighlight">\(H_2^+\)</span>, the model necessarily provides a better representative of the overall physical representation of a molecular bond. The structure depicted in the Polarized basis set plots may not be as intuitive as expected, given our previous experience with representations of p-orbitals and bonding. However, this visual representation can give us insight to how we might best adjust our understanding of orbital and bonding structures. The next task will be to model the <span class="math notranslate nohighlight">\(H_2\)</span> non-ionic molecule. Take some time considering how this model might apply to that system (though the polarized set will not be covered for <span class="math notranslate nohighlight">\(H_2\)</span> in this class). Would you expect applying polarization to the system without electron deficiency to be more or less representative of the physical reality than when applied to <span class="math notranslate nohighlight">\(H_2^+\)</span>?</p>
</section>
</section>
<section id="appendix">
<h2><span class="section-number">4.5.19.12. </span>4.5.19.8 Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading">#</a></h2>
<p>Functional forms for all I, L, M, N, and O functions from the S, J, and K function table.<br />
<br />
For <span class="math notranslate nohighlight">\(S_{1s-2p}\)</span>:<br />
<br />
<span class="math notranslate nohighlight">\(I_1 = 2\frac{sinh(\beta)}{\beta}\)</span> <br />
<span class="math notranslate nohighlight">\(I_2 = \frac{2}{\beta^2}(sinh(\beta) - \beta cosh(\beta))\)</span> <br />
<span class="math notranslate nohighlight">\(I_3 = \frac{2}{\beta^3}((\beta^2+2)sinh(\beta) - 2\beta cosh(\beta))\)</span> <br />
<span class="math notranslate nohighlight">\(I_4 = \frac{2}{\beta^4}( 3(\beta^2+2)sinh(\beta) - \beta(\beta^2 + 6)cosh(/beta))\)</span> <br />
<span class="math notranslate nohighlight">\(I_5 = \frac{e^{-\alpha}}{\alpha}\)</span> <br />
<span class="math notranslate nohighlight">\(I_6 = I_5\frac{\alpha+1}{\alpha}\)</span> <br />
<span class="math notranslate nohighlight">\(I_7 = I_5\frac{\alpha(\alpha+2)+2}{\alpha^2}\)</span> <br />
<span class="math notranslate nohighlight">\(I_8 = I_5\frac{\alpha(\alpha(\alpha+3)+6)+ 6}{\alpha^3}\)</span> <br />
<br />
For <span class="math notranslate nohighlight">\(J_{2p}\)</span>:<br />
<br />
<span class="math notranslate nohighlight">\(L_1 = \frac{2}{Z_2R}sinh(Z_2R)\)</span><br />
<span class="math notranslate nohighlight">\(L_2 = \frac{2}{Z_2^2R^2}(sinh(Z_2R) - Z_2Rcosh(Z_2R))\)</span><br />
<span class="math notranslate nohighlight">\(L_3 = \frac{2}{Z_2^3R^3}(sinh(Z_2R)(Z_2^2R^2+2) - 2Z_2cosh(Z_2R))\)</span><br />
<span class="math notranslate nohighlight">\(L_4 = \frac{2}{Z_2^4R^4}(sinh(Z_2R)(3Z_2^2R^2+6) - cosh(Z_2R)(Z_2^3R^3+6Z_2R))\)</span><br />
<span class="math notranslate nohighlight">\(L_5 = \frac{e^{-Z_2R}}{Z_2R}\)</span><br />
<span class="math notranslate nohighlight">\(L_6 = \frac{L_5}{Z_2R}(Z_2R + 1)\)</span><br />
<span class="math notranslate nohighlight">\(L_7 = \frac{L_5}{Z_2^2R^2}(Z_2^2R^2 + 2Z_2R + 2)\)</span><br />
<span class="math notranslate nohighlight">\(L_8 = \frac{L_5}{Z_2^3R^3}(Z_2^3R^3 + 3Z_2^2R^2 + 6Z_2R + 6)\)</span><br />
<br />
For <span class="math notranslate nohighlight">\(J_{1s-2p}\)</span>:<br />
<br />
<span class="math notranslate nohighlight">\(M_1 = \frac{2}{\alpha}sinh(\alpha)\)</span><br />
<span class="math notranslate nohighlight">\(M_2 = \frac{2}{\alpha^2}(sinh(\alpha)-\alpha cosh(\alpha))\)</span><br />
<span class="math notranslate nohighlight">\(M_3 = \frac{2}{\alpha^3}( (\alpha^2+2)sinh(\alpha) - 2\alpha cosh(\alpha) )\)</span><br />
<span class="math notranslate nohighlight">\(M_4 = \frac{e^{-\alpha}}{\alpha}\)</span><br />
<span class="math notranslate nohighlight">\(M_5 = \frac{e^{-\alpha}}{\alpha^2}(\alpha+1)\)</span><br />
<span class="math notranslate nohighlight">\(M_6 = \frac{e^{-\alpha}}{\alpha^3}(\alpha(\alpha+2)+2)\)</span><br />
<br />
For <span class="math notranslate nohighlight">\(K_{2p}\)</span>:<br />
<br />
<span class="math notranslate nohighlight">\(N_1 = \frac{e^{-Z_2R}}{Z_2^2R^2}(w+1)\)</span><br />
<span class="math notranslate nohighlight">\(N_2 = \frac{e^{-Z_2R}}{Z_2^4R^4}(Z_2^3R^2+3Z_2^2R^2 + 6Z_2R + 6)\)</span><br />
<br />
For <span class="math notranslate nohighlight">\(K_{1s-2p}\)</span> and <span class="math notranslate nohighlight">\(K_{2p-1s}\)</span>:<br />
<br />
<span class="math notranslate nohighlight">\(P_1 = \frac{2}{\beta}sinh(\beta)\)</span><br />
<span class="math notranslate nohighlight">\(P_2 = \frac{2}{\beta^2}(sinh(\beta)- \beta cosh(\beta))\)</span><br />
<span class="math notranslate nohighlight">\(P_3 = \frac{2}{\beta^3}( (\beta^2+2)sinh(\beta) - 2\beta cosh(\beta) ) \)</span><br />
<span class="math notranslate nohighlight">\(P_4 = \frac{e^{-\alpha}}{\alpha}\)</span><br />
<span class="math notranslate nohighlight">\(P_5 = \frac{e^{-\alpha}}{\alpha^2}(\alpha+1)\)</span><br />
<span class="math notranslate nohighlight">\(P_6 = \frac{e^{-\alpha}}{\alpha^2}(\alpha(\alpha+2)+2)\)</span><br />
<br />
Any:<br />
<br />
<span class="math notranslate nohighlight">\(\alpha = 0.5(Z_1+Z_2)R\)</span><br />
<span class="math notranslate nohighlight">\(\beta = 0.5(Z_2-Z_1)R\)</span></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./physical_chemistry/quantum_mechanics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Improving_the_h2%2B_variational_approximation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.5.18. </span>Improving the H<span class="math notranslate nohighlight">\(_2^+\)</span> Variational Approximation</p>
      </div>
    </a>
    <a class="right-next"
       href="H2_Variational_Minimal_Basis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.5.20. </span>The H<span class="math notranslate nohighlight">\(_2\)</span> Molecule using the Variational Method in a Minimal Basis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#authorship">4.5.19.1. Authorship:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">4.5.19.2. Motivation:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">4.5.19.3. Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-concepts">4.5.19.4. Coding Concepts:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-model">4.5.19.5. Setting up the Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-polarization">4.5.19.6. Adding Polarization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-expectation-of-the-hamiltonian">4.5.19.7. Determining the Expectation of the Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#s-ab-z-1-z-2-a-r">4.5.19.7.1. <span class="math notranslate nohighlight">\(S_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#left-langle-phi-a-mid-hat-h-mid-phi-a-right-rangle">4.5.19.7.2. <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_A \right\rangle\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-aa-z-1-z-2-a">4.5.19.7.2.1. <span class="math notranslate nohighlight">\(T_{AA}(Z_1,Z_2,a)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#j-aa-z-1-z-2-a">4.5.19.7.2.2. <span class="math notranslate nohighlight">\(J_{AA}(Z_1,Z_2,a)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#j-ab-z-1-z-2-a-r">4.5.19.7.2.3. <span class="math notranslate nohighlight">\(J_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#left-langle-phi-a-mid-hat-h-mid-phi-b-right-rangle">4.5.19.7.3. <span class="math notranslate nohighlight">\(\left\langle \phi_A \mid \hat{H} \mid \phi_B \right\rangle\)</span>.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-ab-z-1-z-2-a-r">4.5.19.7.3.1. <span class="math notranslate nohighlight">\(K_{AB}(Z_1,Z_2,a,R)\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#t-ab-z1-z2-a-r">4.5.19.7.3.2. <span class="math notranslate nohighlight">\(T_{AB}(Z1,Z2,a,R)\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-coulomb-and-exchange-functions">4.5.19.8. Overlap, Coulomb, and Exchange Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#total-energy">4.5.19.9. Total Energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-the-code">4.5.19.10. Combining the Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphed-comparisons-of-polarization-to-lcao-and-slater-bases">4.5.19.11. Graphed comparisons of Polarization to LCAO and Slater bases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-plots">4.5.19.11.1. Energy Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orbital-densities">4.5.19.11.2. Orbital Densities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">4.5.19.12. 4.5.19.8 Appendix</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Martin McCullagh
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>