
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.4.14. Special Functions in Quantum Mechanics &#8212; Chemistry Lessons with Jupyter Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'physical_chemistry/quantum_mechanics/special_functions_in_quantum_mechanics';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.4.15. The Helium Atom" href="the_helium_atom.html" />
    <link rel="prev" title="3.4.13. The Hydrogen Atom Absorption Spectrum" href="the_hydrogen_atom_absorption_spectrum.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Chemistry Lessons Using Jupyter Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../jupyter_notebook_tutorials/intro.html">1. Jupyter Notebook Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../jupyter_notebook_tutorials/basic_jupyter_notebook_tutorials.html">1.1. Jupyter Notebook Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jupyter_notebook_tutorials/advanced_jupyter_notebook_tutorials.html">1.2. Advanced Jupyter Notebook Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../coding_concepts/intro.html">2. Coding Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/variables.html">2.1. Variables in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/arrays_and_matrices.html">2.2. Arrays and Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/for_loops.html">2.3. for loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/functions.html">2.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/plotting_with_matplotlib.html">2.5. Plotting with matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../coding_concepts/numeric_integration.html">2.6. Numeric Integration</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../intro.html">3. Physical Chemistry</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../statistical_thermodynamics/intro.html">3.1. Statiscial Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Boltzmann_Factor.html">3.1.1. Boltzmann Factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Introduction_to_Probability.html">3.1.2. Introduction to Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Thermodynamic_Properties_from_Partition_Function.html">3.1.3. Thermodynamic Properties from the Partition Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Partition_Function_Monatomic_Ideal_Gas.html">3.1.4. Partition Function for a Monatomic Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Partition_Function_Diatomic_Ideal_Gas.html">3.1.5. Partition Function for a Diatomic Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Classical_Monatomic_Ideal_Gas.html">3.1.6. Classical Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Kinetic_Theory_of_Gasses_from_Classical_Ideal_Gas_Partition_Function.html">3.1.7. Kinetic Theory of Gasses from the Classical Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/microscopic_view_of_entropy.html">3.1.8. Microscopic View of Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistical_thermodynamics/Equations_of_State_From_Lattice_Gas.html">3.1.9. Equations of State from Lattice Gas Models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../thermodynamics/intro.html">3.2. Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/First_Law_of_Thermodynamics.html">3.2.1. The First Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Heat_Work_and_Calculating_U.html">3.2.2. Heat Work and Calculating <span class="math notranslate nohighlight">\(\Delta U\)</span></a></li>

<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Thermodynamic_Cycles.html">3.2.4. Thermodynamic Cycles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Eastham_Honors.html">3.2.5. Three Member Thermodynamic Cycles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Enthalpy.html">3.2.6. Enthalpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/The_Carnot_Cycle.html">3.2.7. The Carnot Cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Second_Law_of_Thermodynamics.html">3.2.8. Second Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Heat_Engine_Diagrams_and_Microscopic_view_Entropy.html">3.2.9. Heat Engine Diagrams</a></li>

<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Third_Law_of_Thermodynamics.html">3.2.11. The Third Law of Thermodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/First_Derivative_and_Maxwell_Relations_of_Thermodynamic_Energy_Functions.html">3.2.12. First Derivative and Maxwell Relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Maxwell_Relations_Applied.html">3.2.13. Maxwell Relations Applied</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Free_Energy_and_Legendre_Transforms.html">3.2.14. Free Energy and Legendre Transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Pressure_and_Temperature_Dependence_Gibbs_Energy.html">3.2.15. The Pressure and Temperature Dependence of the Gibbs Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Phase_Diagrams_and_Phase_Equilibria.html">3.2.16. Phase Diagrams and Phase Equilibria</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Chemical_Potential_from_Partition_Function.html">3.2.17. Chemical Potential from the Partition Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Thermodynamics_of_Solutions.html">3.2.18. Thermodynamics of Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Ideal_and_Non_Ideal_Solutions.html">3.2.19. Ideal and Non-ideal Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../thermodynamics/Introduction_to_Chemical_Equilibrium.html">3.2.20. Chemical Equilibrium</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../kinetics/intro.html">3.3. Kinetics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Chemical_Kinetics_and_Rate_Laws.html">3.3.1. Chemical Kinetics and Rate Laws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Integrated_Rate_Laws.html">3.3.2. Integrated Rate Laws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Reversible_Reactions.html">3.3.3. Reversible Reactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Transition_State_Theory_and_Temperature_Dependence_of_the_Rate_Constant.html">3.3.4. Transition State Theory and Temperature Dependence of the Rate Constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Reaction_Mechanisms_Part_I.html">3.3.5. Reaction Mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Catalysts.html">3.3.6. Catalysts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Enzyme_Kinetics_Michaelis_Menten.html">3.3.7. Enzyme Kinetics: The Michaelis-Menten Mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Cooperative_Binding_Kinetics.html">3.3.8. Cooperative Binding Kinetics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kinetics/Competitive_Inhibition.html">3.3.9. Competitive Inhibition</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="intro.html">3.4. Quantum Mechanics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="history_of_quantum_mechanics.html">3.4.1. The History of Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="wave_particle_duality_classical_wave_equation.html">3.4.2. Wave Particle Duality and the Classical Wave Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Schrodinger_Equation.html">3.4.3. Schrodinger Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="particle_in_a_box.html">3.4.4. Particle in a Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="uncertainty_principle_and_applications_of_particle_in_a_box.html">3.4.5. The Uncertainty Principle and Applications of Particle in a Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="postulates_of_quantum_mechanics.html">3.4.6. The Postulates and Formalism of Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="momentum_operator.html">3.4.7. The Momentum Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="operator_algebra.html">3.4.8. Operator Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="particle_in_a_sphere.html">3.4.9. Particle in a Sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties_of_particle_in_a_sphere.html">3.4.10. Properties of Particle in a Sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_hydrogen_atom.html">3.4.11. The Hydrogen Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="properties_of_the_hydrogen_atom.html">3.4.12. Properties of the Hydrogen Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_hydrogen_atom_absorption_spectrum.html">3.4.13. The Hydrogen Atom Absorption Spectrum</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">3.4.14. Special Functions in Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_helium_atom.html">3.4.15. The Helium Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="variational_method_in_quantum_mechanics.html">3.4.16. Variational Method in Quantum Mechanics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Single_Electron_Molecule_Variational_Approach.html">3.4.17. Single Electron Molecule in the Variational Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="Improving_the_h2%2B_variational_approximation.html">3.4.18. Improving the H<span class="math notranslate nohighlight">\(_2^+\)</span> Variational Approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="H2_Variational_Minimal_Basis.html">3.4.19. The H<span class="math notranslate nohighlight">\(_2\)</span> Molecule using the Variational Method in a Minimal Basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="H2_Configuration_Interaction.html">3.4.20. H<span class="math notranslate nohighlight">\(_2\)</span> Configuration Interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonic_oscillator.html">3.4.21. Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="quantum_mechanics_of_vibrational_spectroscopy.html">3.4.22. Vibrational Spectroscopy</a></li>
<li class="toctree-l3"><a class="reference internal" href="basis_functions.html">3.4.23. Basis Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="harmonic_oscillator_using_variational_method.html">3.4.24. Variational Solution to the Harmonic Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="morse_oscillator.html">3.4.25. The Morse Oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator.html">3.4.26. Rigid Rotator</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator_using_variational_method.html">3.4.27. Rigid Rotator Variational Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="rigid_rotator_selection_rules.html">3.4.28. Rigid Rotator Continuedâ€¦</a></li>

</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../electronic_structure/intro.html">3.5. Electronic Structure</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../electronic_structure/Hartree_Fock_Helium_Atom.html">3.5.1. Hartree-Fock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../electronic_structure/HF_for_H2.html">3.5.2. Hartree-Fock Code for the H2 Molecule in a Minimal STO-3G basis</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/mccullaghlab/mccullaghlab.github.io/main?urlpath=tree/Chemistry_Lessons_Jupyter_Notebooks/physical_chemistry/quantum_mechanics/special_functions_in_quantum_mechanics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/mccullaghlab/mccullaghlab.github.io/blob/main/Chemistry_Lessons_Jupyter_Notebooks/physical_chemistry/quantum_mechanics/special_functions_in_quantum_mechanics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/mccullaghlab/mccullaghlab.github.io/issues/new?title=Issue%20on%20page%20%2Fphysical_chemistry/quantum_mechanics/special_functions_in_quantum_mechanics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button"
   title="Open an issue"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/physical_chemistry/quantum_mechanics/special_functions_in_quantum_mechanics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Special Functions in Quantum Mechanics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">3.4.14.1. Motivation:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">3.4.14.2. Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-concepts">3.4.14.3. Coding Concepts:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#associated-legendre-polynomials">3.4.14.4. Associated Legendre Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-of-the-associated-legendre-polynomials">3.4.14.4.1. Orthogonality of the Associated Legendre Polynomials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-in-quantum-mechanics">3.4.14.4.2. Use in Quantum Mechanics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-bessel-functions">3.4.14.5. Spherical Bessel Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-zeros-of-the-spherical-bessel-functions">3.4.14.5.1. The Zeros of the Spherical Bessel Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-of-the-spherical-bessel-functions">3.4.14.5.2. Orthogonality of the Spherical Bessel Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.4.14.5.3. Use in Quantum Mechanics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-associated-laguerre-polynomials">3.4.14.6. The Associated Laguerre Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limited-orthogonality-of-the-laguerre-polynomials">3.4.14.6.1. Limited Orthogonality of the Laguerre Polynomials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.4.14.6.2. Use in Quantum Mechanics</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="special-functions-in-quantum-mechanics">
<h1><span class="section-number">3.4.14. </span>Special Functions in Quantum Mechanics<a class="headerlink" href="#special-functions-in-quantum-mechanics" title="Permalink to this heading">#</a></h1>
<section id="motivation">
<h2><span class="section-number">3.4.14.1. </span>Motivation:<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>We have encountered a number of new and named functions in this class so far.  This has cause some confusion that I hope to alleviate with these notes.</p>
</section>
<section id="learning-goals">
<h2><span class="section-number">3.4.14.2. </span>Learning Goals:<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>After working through these notes, you will be able to:</p>
<ol class="arabic simple">
<li><p>Identify and use the <em><strong>Associated Legendre Polynomials</strong></em></p></li>
<li><p>Employ the orthogonality relation of the <em><strong>Associated Legendre Polynomials</strong></em></p></li>
<li><p>Identify where <em><strong>Associated Legendre Polynomials</strong></em> show up in QM</p></li>
<li><p>Identify and us the <em><strong>Spherical Bessel Functions</strong></em></p></li>
<li><p>Employ the orthogonality relation of the <em><strong>Spherical Bessel Functions</strong></em></p></li>
<li><p>Identify where <em><strong>Spherical Bessel Functions</strong></em> show up in QM</p></li>
<li><p>Identify and use the <em><strong>Associated Laguerre Polynomials</strong></em></p></li>
<li><p>Identify where the <em><strong>Associated Laguerre Polynomials</strong></em> show up in QM</p></li>
</ol>
</section>
<section id="coding-concepts">
<h2><span class="section-number">3.4.14.3. </span>Coding Concepts:<a class="headerlink" href="#coding-concepts" title="Permalink to this heading">#</a></h2>
<p>The following coding concepts are used in this notebook:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="../../coding_concepts/variables.html"><span class="doc std std-doc">Variables</span></a></p></li>
<li><p><a class="reference internal" href="../../coding_concepts/functions.html"><span class="doc std std-doc">Functions</span></a></p></li>
<li><p><a class="reference internal" href="../../coding_concepts/plotting_with_matplotlib.html"><span class="doc std std-doc">Plotting with matplotlib</span></a></p></li>
</ol>
</section>
<section id="associated-legendre-polynomials">
<h2><span class="section-number">3.4.14.4. </span>Associated Legendre Polynomials<a class="headerlink" href="#associated-legendre-polynomials" title="Permalink to this heading">#</a></h2>
<p>The <em><strong>Associated Legendre Polynomials</strong></em> show up as the solution to the differential equation stemming from the <span class="math notranslate nohighlight">\(\theta\)</span> component of the Laplacian in spherical polar coordinates.  After solving for the <span class="math notranslate nohighlight">\(\phi\)</span> component we end up with the equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-381cb7e8-f5e1-4a12-ba71-ec4bfb02d222">
<span class="eqno">(3.854)<a class="headerlink" href="#equation-381cb7e8-f5e1-4a12-ba71-ec4bfb02d222" title="Permalink to this equation">#</a></span>\[\begin{equation}
m^2 = \frac{\sin\theta}{\Theta(\theta)}\frac{\partial}{\partial\theta}\left(\sin\theta\frac{\partial}{\partial\theta}\right)\Theta(\theta)+\beta\sin^2\theta,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(m=0,\pm 1, \pm 2, ... \)</span> from the periodicity of <span class="math notranslate nohighlight">\(\phi\)</span>. Now make a change of variable <span class="math notranslate nohighlight">\(x = \cos\theta\)</span> which yields <span class="math notranslate nohighlight">\(\frac{dx}{-\sin\theta}=d\theta\)</span> and define <span class="math notranslate nohighlight">\(P(x) = \Theta(\theta)\)</span>.  Plugging these in and performing some rearrangements yields a differential equation that matches the <em><strong>general Legendre equation</strong></em></p>
<div class="amsmath math notranslate nohighlight" id="equation-605536b8-09db-47fb-a381-e38a4a6e93e9">
<span class="eqno">(3.855)<a class="headerlink" href="#equation-605536b8-09db-47fb-a381-e38a4a6e93e9" title="Permalink to this equation">#</a></span>\[\begin{equation}
(1-x^2)\frac{d^2P(x)}{dx^2}-2x\frac{dP(x)}{dx}+\left[\beta-\frac{m^2}{1-x^2}\right]P(x) = 0
\end{equation}\]</div>
<p>It turns out that for <span class="math notranslate nohighlight">\(\Theta(\theta)\)</span> to be continous <span class="math notranslate nohighlight">\(\beta=l(l+1)\)</span> where <span class="math notranslate nohighlight">\(l=0,1,2...\)</span>.  Note that this also puts a limit on <span class="math notranslate nohighlight">\(m\)</span> with <span class="math notranslate nohighlight">\(m=0,1, 2, ... , l\)</span>.</p>
<p>The solutions, <span class="math notranslate nohighlight">\(P_l^m(x)\)</span>, to the above equation are known as the <em><strong>Associated Legendre Polynomials</strong></em>.  The specific functional form of these functions depends on both indeces <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(l\)</span>.  Index <span class="math notranslate nohighlight">\(l\)</span> is referred to as the degree and <span class="math notranslate nohighlight">\(m\)</span> is referred to as the order of the <em><strong>Associated Legendre Polynomial</strong></em>.  The functions can be determined in a number of ways.  A recursive formula for these functions is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9576edb4-4d16-4f3c-9266-13e13db61dfe">
<span class="eqno">(3.856)<a class="headerlink" href="#equation-9576edb4-4d16-4f3c-9266-13e13db61dfe" title="Permalink to this equation">#</a></span>\[\begin{equation}
P_l^m(x) = (-1)^m(1-x^2)^{m/2}\frac{d^m}{dx^m}P_l(x),
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_l(x)\)</span> are the <em><strong>Legendre polynomials</strong></em>.  The <em><strong>Legendre polynomials</strong></em> are solutions to the <em><strong>Legendre equation</strong></em> which differs from the <em><strong>general Legendre equation</strong></em> by the exclusion of the <span class="math notranslate nohighlight">\(-\frac{m^2}{1-x^2}\)</span> term.</p>
<p>In order to use the above equation to determine a specific functional form for the <em><strong>Associated Legendre Polynomials</strong></em> you need to know the target <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(l\)</span> as well as the <em><strong>Legendre polynomial</strong></em> <span class="math notranslate nohighlight">\(P_l(x)\)</span>.  There are a number of ways of defining these functions but perhaps the easiest way is the Rodriguez formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-40cdd8eb-b2f0-4858-90ac-e45b8f2ad5a8">
<span class="eqno">(3.857)<a class="headerlink" href="#equation-40cdd8eb-b2f0-4858-90ac-e45b8f2ad5a8" title="Permalink to this equation">#</a></span>\[\begin{equation}
P_l(x) = \frac{1}{2^ll!}\frac{d^l}{dx^l}\left(x^2-1\right)^l
\end{equation}\]</div>
<p>In general, however, it is easier to just look up the specific function.  Below is a table of the first few <em><strong>Associated Lengedre polynomials</strong></em> followed by a plot of these functions</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p><span class="math notranslate nohighlight">\(l\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(m\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(P_l^m(x)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>0</p></td>
<td class="text-left"><p>0</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(P_0^0(x) = 1\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(P_1^{-1}(x) = \frac{1}{2}\sqrt{1-x^2}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(P_1^{0}(x) = x\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(P_1^{-1}(x) = -\sqrt{1-x^2}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot of some of the Legendre polynomials</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">lpmv</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;l=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, m=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">lpmv</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Associated Lengedre Polynomials&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/cea7b5cbf607b6ed2da058e9ead9abb39f6a1f5822da9ea77d3181a358516762.png" src="../../_images/cea7b5cbf607b6ed2da058e9ead9abb39f6a1f5822da9ea77d3181a358516762.png" />
</div>
</div>
<section id="orthogonality-of-the-associated-legendre-polynomials">
<h3><span class="section-number">3.4.14.4.1. </span>Orthogonality of the Associated Legendre Polynomials<a class="headerlink" href="#orthogonality-of-the-associated-legendre-polynomials" title="Permalink to this heading">#</a></h3>
<p>The <em><strong>Associated Legendre Polynomials</strong></em> have the following orthogonality rules over the domain <span class="math notranslate nohighlight">\(-1 \leq x \leq 1\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-4ebd145a-1a21-4739-a0c6-0f0e4e530d2a">
<span class="eqno">(3.858)<a class="headerlink" href="#equation-4ebd145a-1a21-4739-a0c6-0f0e4e530d2a" title="Permalink to this equation">#</a></span>\[\begin{equation}
\left\langle P_l^m|P_{l'}^m \right\rangle = \int_{-1}^{1} P_l^m(x)P_{l'}^m(x)dx = \frac{2(l+m)!}{(2l+1)(l-m)!}\delta_{l,l'}
\end{equation}\]</div>
<p>That being that if <span class="math notranslate nohighlight">\(m\)</span> is kept constant, then an Associated Legendre Polynomial of one <span class="math notranslate nohighlight">\(l\)</span> value is orthogonal to an Associated Legendre Polynomial with a different <span class="math notranslate nohighlight">\(l\)</span> value.  A more general orthogonality relationship does not exist.  As you can see from the table below, certain pairs of Associated Legendre Polynomials are not orthogonal (e.g. <span class="math notranslate nohighlight">\(P_0^0\)</span> and <span class="math notranslate nohighlight">\(P_1^1\)</span>).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">lpmv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>

<span class="k">def</span> <span class="nf">theta_norm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))))</span>
<span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta_norm</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">l1</span><span class="p">)</span><span class="o">*</span><span class="n">lpmv</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">theta_norm</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span><span class="n">l2</span><span class="p">)</span><span class="o">*</span><span class="n">lpmv</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;20}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;l</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;m</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;Theta_ml | Theta_m</span><span class="se">\&#39;</span><span class="s1">l</span><span class="se">\&#39;</span><span class="s1">&gt;&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------------------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l1</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;20}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">l2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l        m        l&#39;       m&#39;       &lt;Theta_ml | Theta_m&#39;l&#39;&gt;
-------------------------------------------------------------------------
0        0        0        0        1.0                 
0        0        1        0        0.0                 
0        0        1        1        -0.962              
0        0        2        0        0.0                 
0        0        2        1        -0.0                
0        0        2        2        0.913               
1        0        1        0        1.0                 
1        0        1        1        0.0                 
1        0        2        0        0.0                 
1        0        2        1        -0.931              
1        0        2        2        -0.0                
1        1        1        0        -0.0                
1        1        1        1        1.0                 
1        1        2        0        0.269               
1        1        2        1        0.0                 
1        1        2        2        -0.988              
2        0        2        0        1.0                 
2        0        2        1        -0.0                
2        0        2        2        -0.408              
2        1        2        0        -0.0                
2        1        2        1        1.0                 
2        1        2        2        -0.0                
2        2        2        0        -0.408              
2        2        2        1        -0.0                
2        2        2        2        1.0                 
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-in-quantum-mechanics">
<h3><span class="section-number">3.4.14.4.2. </span>Use in Quantum Mechanics<a class="headerlink" href="#use-in-quantum-mechanics" title="Permalink to this heading">#</a></h3>
<p>The use of <em><strong>Associated Legendre Polynomials</strong></em> in quantum mechanics is obscured because of their inclusion in the spherical harmonics.  These functions account for both the <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> components with the <span class="math notranslate nohighlight">\(\theta\)</span> component being the Associated Legendre Polynomials.  The orthogonality of these functions combined with the <span class="math notranslate nohighlight">\(\phi\)</span> solutions is what yields the orthogonality of the spherical harmonics.</p>
<p>The normalized spherical harmonics are given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-26bb9414-b7f2-41b3-ad93-3712a50051f2">
<span class="eqno">(3.859)<a class="headerlink" href="#equation-26bb9414-b7f2-41b3-ad93-3712a50051f2" title="Permalink to this equation">#</a></span>\[\begin{equation}
 Y_l^m = \sqrt{\frac{(2l+1)(l-|m|)!}{4\pi(l+|m|)!}}P_l^{|m|}(\cos\theta)e^{im\phi}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_l^{|m|}(\cos\theta)\)</span> is the <em><strong>Associated Legendre Polynomial</strong></em> of degree <span class="math notranslate nohighlight">\(l\)</span> and order <span class="math notranslate nohighlight">\(|m|\)</span>.</p>
<p>These functions do form a complete orthonormal basis for the space of <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>.  The orthonormality relationship for these functions is given as</p>
<div class="amsmath math notranslate nohighlight" id="equation-101fbaed-4a15-4448-8401-7f07d479e433">
<span class="eqno">(3.860)<a class="headerlink" href="#equation-101fbaed-4a15-4448-8401-7f07d479e433" title="Permalink to this equation">#</a></span>\[\begin{equation}
\left\langle Y_l^m | Y_{l'}^{m'} \right\rangle = \delta_{l,l'}\delta_{m,m'}
\end{equation}\]</div>
<p>Notice that the above orthogonality of the spherical harmonics and the lack of orthogonality of the <em><strong>Associated Legendre Polynomials</strong></em> when <span class="math notranslate nohighlight">\(m\neq m'\)</span> requires that the <span class="math notranslate nohighlight">\(\phi\)</span> component be orthogonal when <span class="math notranslate nohighlight">\(m\neq m'\)</span>.  We can demonstrate that with code (below) or simply recognize that</p>
<div class="amsmath math notranslate nohighlight" id="equation-0390504b-c0d3-49a0-b073-e8fb6ce37556">
<span class="eqno">(3.861)<a class="headerlink" href="#equation-0390504b-c0d3-49a0-b073-e8fb6ce37556" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_0^{2\pi} e^{i(m-m')\phi}d\phi = 2\pi\delta_{m,m'}
\end{equation}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">lpmv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">phi_norm2</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">real_integrand</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">phi_norm2</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">m1</span><span class="o">-</span><span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">im_integrand</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">phi_norm2</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">m1</span><span class="o">-</span><span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;m</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;Re&lt;Phi_m | Phi_m</span><span class="se">\&#39;</span><span class="s1">&gt;&#39;</span><span class="p">,</span><span class="s1">&#39;Im&lt;Phi_m | Phi_m</span><span class="se">\&#39;</span><span class="s1">&gt;&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------------------------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">real_integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">im_integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m        m&#39;       Re&lt;Phi_m | Phi_m&#39;&gt;             Im&lt;Phi_m | Phi_m&#39;&gt;            
--------------------------------------------------------------------
0        0        1.0                            0.0                           
0        1        0.0                            -0.0                          
0        2        -0.0                           0.0                           
0        3        -0.0                           -0.0                          
1        1        1.0                            0.0                           
1        2        0.0                            -0.0                          
1        3        -0.0                           0.0                           
2        2        1.0                            0.0                           
2        3        0.0                            -0.0                          
3        3        1.0                            0.0                           
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="spherical-bessel-functions">
<h2><span class="section-number">3.4.14.5. </span>Spherical Bessel Functions<a class="headerlink" href="#spherical-bessel-functions" title="Permalink to this heading">#</a></h2>
<p>The <em><strong>Spherical Bessel Functions</strong></em> show up as the solutions to the radial component of the <a class="reference internal" href="particle_in_a_sphere.html"><span class="doc std std-doc">particle in a sphere</span></a>.   In our solution for the radial component, <span class="math notranslate nohighlight">\(r\)</span>, we started with an equation that resembled</p>
<div class="amsmath math notranslate nohighlight" id="equation-6cc26a22-d63a-4db0-8070-c8c4a5396a7b">
<span class="eqno">(3.862)<a class="headerlink" href="#equation-6cc26a22-d63a-4db0-8070-c8c4a5396a7b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\hbar^2}{R(r)}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)R(r) + 2mr^2E = \hbar^2l(l+1)
\end{equation}\]</div>
<p>where the <span class="math notranslate nohighlight">\(l(l+1)\)</span> part comes from the angular solutions.  Rearranging yields</p>
<div class="amsmath math notranslate nohighlight" id="equation-e0a1aa55-4882-4038-8bbc-7fbee9b2fcdd">
<span class="eqno">(3.863)<a class="headerlink" href="#equation-e0a1aa55-4882-4038-8bbc-7fbee9b2fcdd" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)R(r) + \left(\frac{2mE}{\hbar^2}r^2 - l(l+1)\right)R(r) = 0
\end{equation}\]</div>
<p>Now expanding the first term using the product rule we get</p>
<div class="amsmath math notranslate nohighlight" id="equation-d5592e61-a79c-4745-8b85-b007023c86f2">
<span class="eqno">(3.864)<a class="headerlink" href="#equation-d5592e61-a79c-4745-8b85-b007023c86f2" title="Permalink to this equation">#</a></span>\[\begin{align}
&amp;\left(r^2\frac{\partial^2R(r)}{\partial r^2} + 2r\frac{\partial R(r)}{\partial r}\right) + \left(\frac{2mE}{\hbar^2}r^2 - l(l+1)\right)R(r) = 0 \\
&amp;r^2\frac{\partial^2R(r)}{\partial r^2} + 2r\frac{\partial R(r)}{\partial r} + \left(\frac{2mE}{\hbar^2}r^2 - l(l+1)\right)R(r) = 0
\end{align}\]</div>
<p>The above expression resembles a differential equation of the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-12aeb350-9c8e-4695-8151-257a5d964737">
<span class="eqno">(3.865)<a class="headerlink" href="#equation-12aeb350-9c8e-4695-8151-257a5d964737" title="Permalink to this equation">#</a></span>\[\begin{equation}
x^2\frac{d^2y(x)}{d x^2} + 2x\frac{d y(x)}{d x} + \left(x^2 - l(l+1)\right)y(x) = 0,
\end{equation}\]</div>
<p>that has the <em><strong>spherical Bessel functions</strong></em> as the solutions.  To get the final manipulation we must set <span class="math notranslate nohighlight">\(x^2= \frac{2mE}{\hbar^2}r^2\)</span> or <span class="math notranslate nohighlight">\(x = \frac{\sqrt{2mE}}{\hbar}r\)</span>.   Additionally, we introduce a new function <span class="math notranslate nohighlight">\(y(x) = R(r)\)</span> and recognize that</p>
<div class="amsmath math notranslate nohighlight" id="equation-0305b7b1-2420-4b1d-adc8-2c83e5507cdc">
<span class="eqno">(3.866)<a class="headerlink" href="#equation-0305b7b1-2420-4b1d-adc8-2c83e5507cdc" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{d y(x)}{dx} &amp;= \frac{dr}{dx}\frac{dR(r)}{dr} \\
\frac{d^2 y(x)}{dx^2} &amp;= \frac{dr}{dx}\frac{dr}{dx}\frac{d^2R(r)}{dr^2}
\end{align}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-db38d7ba-05ed-42d1-a314-6ed4440659b9">
<span class="eqno">(3.867)<a class="headerlink" href="#equation-db38d7ba-05ed-42d1-a314-6ed4440659b9" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{dR(r)}{dr} &amp;=  \frac{dx}{dr}\frac{d y(x)}{dx} \\
\frac{d^2R(r)}{dr^2} &amp;= \left(\frac{dx}{dr}\right)^2\frac{d^2 y(x)}{dx^2}
\end{align}\]</div>
<p>Thus, we can see that our final radial differential equation will be exactly of the form for which the <em><strong>spherical Bessel functions</strong></em> are the solutions.  Note, however, that the independent variable is actually <span class="math notranslate nohighlight">\(x = \frac{\sqrt{2mE}}{\hbar}r\)</span>.</p>
<p>The <em><strong>spherical Bessel functions</strong></em> have two types.  We will ignore the second type because it can be discarded as a solution to our problem due to postulate 1 of quantum mechanics (the function is not finite in the domain).  The spherical Bessel functions of the first type are denoted <span class="math notranslate nohighlight">\(j_l(x)\)</span> as the specific functional form of these depends on the index <span class="math notranslate nohighlight">\(l\)</span>.  These functions are related to the <em><strong>ordinary Bessel functions</strong></em> of the first type, <span class="math notranslate nohighlight">\(J_l(x)\)</span>, by the following relationship</p>
<div class="amsmath math notranslate nohighlight" id="equation-0b7d4c28-50d9-42bb-ac7d-a8d35c359469">
<span class="eqno">(3.868)<a class="headerlink" href="#equation-0b7d4c28-50d9-42bb-ac7d-a8d35c359469" title="Permalink to this equation">#</a></span>\[\begin{equation}
j_l(x) = \sqrt{\frac{\pi}{2x}}J_{l+\frac{1}{2}}(x)
\end{equation}\]</div>
<p>The spherical Bessel functions can also be determined using <em><strong>Rayleighâ€™s formula</strong></em> for them:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ee54e3e7-44d9-463d-89ed-1eb14a57154e">
<span class="eqno">(3.869)<a class="headerlink" href="#equation-ee54e3e7-44d9-463d-89ed-1eb14a57154e" title="Permalink to this equation">#</a></span>\[\begin{equation}
j_l(x) = (-x)^l\left(\frac{1}{x}\frac{d}{dx}\right)^l\frac{\sin x}{x}
\end{equation}\]</div>
<p>The above equation can be used to determine the spherical Bessel function of the first type for integer <span class="math notranslate nohighlight">\(l\)</span>.  It is likely easier, however, to look up a table of these such as the one given below</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p><span class="math notranslate nohighlight">\(l\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(j_l(x)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>0</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(j_0(x) = \frac{\sin x}{x}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(j_1(x) = \frac{\sin x}{x^2} - \frac{\cos x}{x}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(j_2(x) = \left(\frac{3}{x^2} - 1 \right)\frac{\sin x}{x} - \frac{3\cos x}{x^2}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### import numpy as np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">spherical_jn</span><span class="p">,</span> <span class="n">spherical_yn</span>
<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$j_l$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$j_l(x)$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$l=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="c1"># second type</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y_l$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">fontsize</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spherical_yn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$l=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y_l(x)$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">td</span><span class="o">/</span><span class="n">dll8n_kj4vd0zxjm0xd9m7740000gq</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_24619</span><span class="o">/</span><span class="mf">2310059482.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">spherical_jn</span><span class="p">,</span> <span class="n">spherical_yn</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;np&#39; is not defined
</pre></div>
</div>
</div>
</div>
<section id="the-zeros-of-the-spherical-bessel-functions">
<h3><span class="section-number">3.4.14.5.1. </span>The Zeros of the Spherical Bessel Functions<a class="headerlink" href="#the-zeros-of-the-spherical-bessel-functions" title="Permalink to this heading">#</a></h3>
<p>The values of <span class="math notranslate nohighlight">\(x\)</span> for which</p>
<div class="amsmath math notranslate nohighlight" id="equation-c1d6d618-1ae0-41db-850f-3684d5b16dd8">
<span class="eqno">(3.870)<a class="headerlink" href="#equation-c1d6d618-1ae0-41db-850f-3684d5b16dd8" title="Permalink to this equation">#</a></span>\[\begin{equation}
j_l(x) = 0
\end{equation}\]</div>
<p>are important for the problem of particle in a sphere because the boundary conditions of the problem dictate that</p>
<div class="amsmath math notranslate nohighlight" id="equation-4d6235f9-949e-4887-896a-4a9b9a587620">
<span class="eqno">(3.871)<a class="headerlink" href="#equation-4d6235f9-949e-4887-896a-4a9b9a587620" title="Permalink to this equation">#</a></span>\[\begin{equation}
R(r_0) = 0
\end{equation}\]</div>
<p>for the sphere radius <span class="math notranslate nohighlight">\(r_0\)</span>.</p>
<p>As may be evident in the plot above, each <span class="math notranslate nohighlight">\(j_l(x)\)</span> function will continue to oscillate as <span class="math notranslate nohighlight">\(x\rightarrow\infty\)</span>.  This means that there will be an infinite number of <span class="math notranslate nohighlight">\(x\)</span> positions at which <span class="math notranslate nohighlight">\(j_l(x)=0\)</span>.  We will denote these <span class="math notranslate nohighlight">\(x\)</span> values as <span class="math notranslate nohighlight">\(\beta_{n,l}\)</span>, or the <span class="math notranslate nohighlight">\(n\)</span>th <span class="math notranslate nohighlight">\(x\)</span> value for which <span class="math notranslate nohighlight">\(l\)</span>th spherical Bessel function crosses zero.   There is no easy way to determine these values for arbitrary <span class="math notranslate nohighlight">\(l\)</span> so we just tabulate them</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>l\n</p></th>
<th class="head text-left"><p>1</p></th>
<th class="head text-left"><p>2</p></th>
<th class="head text-left"><p>3</p></th>
<th class="head text-left"><p>4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>0</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(\pi\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(2\pi\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(3\pi\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(4\pi\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>4.493</p></td>
<td class="text-left"><p>7.725</p></td>
<td class="text-left"><p>10.904</p></td>
<td class="text-left"><p>14.066</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>2</p></td>
<td class="text-left"><p>5.763</p></td>
<td class="text-left"><p>9.095</p></td>
<td class="text-left"><p>12.322</p></td>
<td class="text-left"><p>15.515</p></td>
</tr>
</tbody>
</table>
<p>When we use these zeros and solve for the energy etc, we get that the radial wavefunction for the particle in a sphere has the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-58e1ff1f-cf2e-42f0-8bb6-46f41fdd1e87">
<span class="eqno">(3.872)<a class="headerlink" href="#equation-58e1ff1f-cf2e-42f0-8bb6-46f41fdd1e87" title="Permalink to this equation">#</a></span>\[\begin{equation}
R_{l,n}(r) = Aj_l\left(\frac{\beta_{n,l}}{r_0}r\right)
\end{equation}\]</div>
</section>
<section id="orthogonality-of-the-spherical-bessel-functions">
<h3><span class="section-number">3.4.14.5.2. </span>Orthogonality of the Spherical Bessel Functions<a class="headerlink" href="#orthogonality-of-the-spherical-bessel-functions" title="Permalink to this heading">#</a></h3>
<p>The <em><strong>spherical Bessel Functions</strong></em>, <span class="math notranslate nohighlight">\(j_l\left(\frac{\beta_{n,l}r}{r_0}\right)\)</span> are orthogonal for different <span class="math notranslate nohighlight">\(n\)</span> and constant <span class="math notranslate nohighlight">\(l\)</span> over the domain <span class="math notranslate nohighlight">\(0 \leq r &lt; r_0\)</span>.  This orthonormality can be expressed as follows</p>
<div class="amsmath math notranslate nohighlight" id="equation-a2cb7995-7151-4b8e-aab8-50fd895d9c69">
<span class="eqno">(3.873)<a class="headerlink" href="#equation-a2cb7995-7151-4b8e-aab8-50fd895d9c69" title="Permalink to this equation">#</a></span>\[\begin{equation}
\left\langle j_l\left(\frac{\beta_{n,l}}{r_0}r\right) | j_{l}\left(\frac{\beta_{n',l}}{r_0}r\right)\right\rangle = \int_0^{r_0} j_l\left(\frac{\beta_{n,l}}{r_0}r\right) j_{l}\left(\frac{\beta_{n',l}}{r_0}r\right) r^2dr = \frac{r_0^3\delta_{nn'}}{2}\left[ j_{l+1}(\beta_{n,l})\right]
\end{equation}\]</div>
<p>Notice that this orthonormality is for the different zeros of the same spherical Bessel function.  The orthogonality of different <span class="math notranslate nohighlight">\(l\)</span>s is not guaranteed.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">spherical_jn</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
    
<span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="n">zero_l1n1</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
    <span class="n">zero_l2n2</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r_norm</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l1n1</span><span class="p">)</span><span class="o">*</span><span class="n">r_norm</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l2n2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">r_norm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="n">zero_ln</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">zero_ln</span><span class="p">))</span>
    
    
<span class="k">def</span> <span class="nf">spherical_jn_zero</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ngrid</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns nth zero of spherical bessel function of order l</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># calculate on a sensible grid</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">ngrid</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
        <span class="c1"># Find m good initial guesses from where y switches sign</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ind0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diffs</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="n">n</span><span class="p">]</span>  <span class="c1"># first m times sign of y changes</span>
        <span class="n">x0s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind0s</span><span class="p">]</span>
    
        <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">x0s</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;n</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;l</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;j_l(b_nl r) | j_l</span><span class="se">\&#39;</span><span class="s1">(b_n</span><span class="se">\&#39;</span><span class="s1">l</span><span class="se">\&#39;</span><span class="s1"> r)&gt;&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------------------------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;8}</span><span class="s2"> </span><span class="si">{:&lt;30}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n        l        n&#39;       l&#39;       &lt;j_l(b_nl r) | j_l&#39;(b_n&#39;l&#39; r)&gt;
--------------------------------------------------------------------
1        0        1        0        1.0                           
1        0        2        0        0.0                           
1        0        3        0        -0.0                          
1        0        1        1        0.959                         
1        0        2        1        -0.242                        
1        0        3        1        0.112                         
1        0        1        2        0.89                          
1        0        2        2        -0.368                        
1        0        3        2        0.196                         
2        0        1        0        0.0                           
2        0        2        0        1.0                           
2        0        3        0        0.0                           
2        0        1        1        0.279                         
2        0        2        1        0.895                         
2        0        3        1        -0.281                        
2        0        1        2        0.455                         
2        0        2        2        0.708                         
2        0        3        2        -0.396                        
3        0        1        0        0.0                           
3        0        2        0        -0.0                          
3        0        3        0        1.0                           
3        0        1        1        -0.043                        
3        0        2        1        0.366                         
3        0        3        1        0.852                         
3        0        1        2        0.008                         
3        0        2        2        0.603                         
3        0        3        2        0.577                         
1        1        1        0        0.959                         
1        1        2        0        0.279                         
1        1        3        0        -0.043                        
1        1        1        1        1.0                           
1        1        2        1        -0.0                          
1        1        3        1        -0.0                          
1        1        1        2        0.981                         
1        1        2        2        -0.181                        
1        1        3        2        0.064                         
2        1        1        0        -0.242                        
2        1        2        0        0.895                         
2        1        3        0        0.366                         
2        1        1        1        -0.0                          
2        1        2        1        1.0                           
2        1        3        1        0.0                           
2        1        1        2        0.195                         
2        1        2        2        0.943                         
2        1        3        2        -0.239                        
3        1        1        0        0.112                         
3        1        2        0        -0.281                        
3        1        3        0        0.852                         
3        1        1        1        -0.0                          
3        1        2        1        0.0                           
3        1        3        1        1.0                           
3        1        1        2        -0.021                        
3        1        2        2        0.276                         
3        1        3        2        0.91                          
1        2        1        0        0.89                          
1        2        2        0        0.455                         
1        2        3        0        0.008                         
1        2        1        1        0.981                         
1        2        2        1        0.195                         
1        2        3        1        -0.021                        
1        2        1        2        1.0                           
1        2        2        2        0.0                           
1        2        3        2        -0.0                          
2        2        1        0        -0.368                        
2        2        2        0        0.708                         
2        2        3        0        0.603                         
2        2        1        1        -0.181                        
2        2        2        1        0.943                         
2        2        3        1        0.276                         
2        2        1        2        0.0                           
2        2        2        2        1.0                           
2        2        3        2        -0.0                          
3        2        1        0        0.196                         
3        2        2        0        -0.396                        
3        2        3        0        0.577                         
3        2        1        1        0.064                         
3        2        2        1        -0.239                        
3        2        3        1        0.91                          
3        2        1        2        -0.0                          
3        2        2        2        -0.0                          
3        2        3        2        1.0                           
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">j1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
<span class="k">def</span> <span class="nf">j2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">r_int</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">zero_41</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">j2</span><span class="p">(</span><span class="n">zero_41</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">j1</span><span class="p">(</span><span class="n">zero_41</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">int1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">beta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">int2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">beta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">int3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">beta</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;int1:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;int2:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;int3:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">spherical_jn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zero_41</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">int3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zero_41</span><span class="p">))[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">r_int</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">spherical_jn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zero_41</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">1.294e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int1: 4.9911975147348385e-05
int2: 0.0012698875933548103
int3: 2.5415821093449187e-05
0.5147966377079543
0.0012943837474087094
0.51464401536846
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">r_integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="n">zero_ln</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">r_norm</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">zero_ln</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">r_norm</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">zero_ln</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">r_integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5147966377079543
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zero_41</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zero_41</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;j_2(beta_41) = &quot;</span><span class="p">,</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">zero_41</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.066193912831473
j_2(beta_41) =  -0.07091345945046217
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3><span class="section-number">3.4.14.5.3. </span>Use in Quantum Mechanics<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>The spherical Bessel functions are the solutions to the radial component of the particle in a sphere.  The ordinary Bessel functions are the solutions to the radial component of the particle in a disc/circle.  These functions show up in spherically symmetric bounded problems with no potential. We are unlikely to encounter them again in this class.</p>
</section>
</section>
<section id="the-associated-laguerre-polynomials">
<h2><span class="section-number">3.4.14.6. </span>The Associated Laguerre Polynomials<a class="headerlink" href="#the-associated-laguerre-polynomials" title="Permalink to this heading">#</a></h2>
<p>The <em><strong>Associated Laguerre Polynomials</strong></em> are a component of the radial solution to the hydrogen atom Schrodinger equation.  After solving the angular component, the following differential equation can be achieved</p>
<p><span class="math notranslate nohighlight">\(-\frac{\hbar^2}{2m_er^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)R(r)+\left[\frac{\hbar^2l(l+1)}{2m_er^2} + V(r)-E\right]R(r) =0 \)</span>.</p>
<p>This can be solved using power series solutions to differential equations but we will not go through it. Instead we will present the energies and wavefunctions</p>
<p><span class="math notranslate nohighlight">\(E_n = - \frac{m_ee^4}{8\epsilon_0^2h^2n^2} = - \frac{e^2}{8\pi\epsilon_0a_0n^2}\)</span></p>
<p>for <span class="math notranslate nohighlight">\(n=1,2,...\)</span> and <span class="math notranslate nohighlight">\(a_0 = \frac{\epsilon_0h^2}{\pi m_ee^2}\)</span> is the Bohr radius.  These are actually the same energies obtained from the Bohr model of the hydrogen atom.  Also notice that the energies are independent of <span class="math notranslate nohighlight">\(l\)</span>.  It should be noted that <span class="math notranslate nohighlight">\(n\geq l+1 \)</span> or <span class="math notranslate nohighlight">\(0 \leq l \leq n-1\)</span> for <span class="math notranslate nohighlight">\(n=1,2,..\)</span>.</p>
<p>The radial wavefunction solution to the equation above is given as</p>
<p><span class="math notranslate nohighlight">\(R_{nl} = A_r r^le^{-r/na_0}L_{n+l}^{2l+1}\left( \frac{2r}{na_0}\right)\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(L_{n+l}^{2l+1}\)</span> are the <em><strong>associated Laguerre polynomials</strong></em>. Here is a table of the first few examples of these functions</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p><span class="math notranslate nohighlight">\(n, l\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(L_{n+l}^{2l+1}(x)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(1, 0\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_1^1(x)= -1\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(2, 0\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_2^1(x)= -2(2-x)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(2, 1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_3^3(x)= -3!\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(3, 0\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_3^1(x)= -3!(3-3x+\frac{1}{2}x^2)\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(3, 1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_4^3(x)= -4!(4-x)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(3, 2\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(L_5^5(x)= -5!\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s plot some radial wavefunctions of the hydrogen atom</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_genlaguerre</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#808080&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Hydrogen Atom Radial Wave Functions&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">);</span>
<span class="c1"># parameters for plotting</span>
<span class="n">nLimit</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">a0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nLimit</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">l</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mf">1.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">prefactor</span><span class="o">*</span><span class="n">eval_genlaguerre</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;n=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; l=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r$ (Bohr)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R(r)$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../../_images/5fd5ba725acbc3b1b3e47170290304c159c69f2cb07111a7153f207943081721.png" src="../../_images/5fd5ba725acbc3b1b3e47170290304c159c69f2cb07111a7153f207943081721.png" />
</div>
</div>
<section id="limited-orthogonality-of-the-laguerre-polynomials">
<h3><span class="section-number">3.4.14.6.1. </span>Limited Orthogonality of the Laguerre Polynomials<a class="headerlink" href="#limited-orthogonality-of-the-laguerre-polynomials" title="Permalink to this heading">#</a></h3>
<p>The generalized Laguerre polynomials are not orthogonal themselves but are orthogonal over <span class="math notranslate nohighlight">\([0,\infty)\)</span> with weighting function <span class="math notranslate nohighlight">\(x^\alpha e^{-x}\)</span>.  That is</p>
<div class="amsmath math notranslate nohighlight" id="equation-48019497-8563-4b8b-a00e-62a5d1cddefa">
<span class="eqno">(3.874)<a class="headerlink" href="#equation-48019497-8563-4b8b-a00e-62a5d1cddefa" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_0^\infty x^\alpha e^{-x} L_n^{(\alpha)}(x)L_m^{(\alpha)}(x)dx = \frac{\Gamma(n+\alpha+1)}{n!}\delta_{n,m}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma\)</span> is the gamma function and <span class="math notranslate nohighlight">\(\delta_{n,m}\)</span> is defined by</p>
<div class="amsmath math notranslate nohighlight" id="equation-3a4b0f25-2d34-451a-8a45-f67027431eae">
<span class="eqno">(3.875)<a class="headerlink" href="#equation-3a4b0f25-2d34-451a-8a45-f67027431eae" title="Permalink to this equation">#</a></span>\[\begin{equation}
\delta_{n,m} = \begin{cases} 1 \quad\text{ if }n=m \\ 0 \quad\text{ otherwise}\end{cases}
\end{equation}\]</div>
<p>That particular orthogonality condition is not that useful for us but it can also be shown that</p>
<div class="amsmath math notranslate nohighlight" id="equation-3daa34d8-2635-4b1c-8092-4ae9fa2dc8ef">
<span class="eqno">(3.876)<a class="headerlink" href="#equation-3daa34d8-2635-4b1c-8092-4ae9fa2dc8ef" title="Permalink to this equation">#</a></span>\[\begin{equation}
\int_0^\infty x^{(\alpha+1)} e^{-x} L_n^{(\alpha)}(x)L_m^{(\alpha)}(x)dx = \frac{2n[(n+\frac{\alpha-1}{2})!]^3}{(n-\frac{(\alpha-1)}{2}-1)!}\delta_{n,m}
\end{equation}\]</div>
<p>This relationship indicates that any two hydrogen atom wave functions differing in primary quantum number <span class="math notranslate nohighlight">\(n\)</span> and not <span class="math notranslate nohighlight">\(l\)</span> will be orthogonal.  We will see that demonstrated in the table below</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_genlaguerre</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="n">a0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># radial unit of Bohr!    </span>
<span class="k">def</span> <span class="nf">hydrogen_atom_radial_wf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="n">R_prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">l</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mf">1.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">R_prefactor</span><span class="o">*</span><span class="n">eval_genlaguerre</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">a0</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">hydrogen_atom_radial_wf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">)</span><span class="o">*</span><span class="n">hydrogen_atom_radial_wf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;20}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;n</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;l</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;R_nl | R_n</span><span class="se">\&#39;</span><span class="s1">l</span><span class="se">\&#39;</span><span class="s1">&gt;&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------------------------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;10}</span><span class="s2"> </span><span class="si">{:&lt;20}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">infty</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n          l          n&#39;         l&#39;         &lt;R_nl | R_n&#39;l&#39;&gt;     
--------------------------------------------------------------------
1          0          1          0          1.0                 
1          0          2          0          -0.0                
1          0          2          1          0.484               
1          0          3          0          -0.0                
1          0          3          1          0.23                
1          0          3          2          0.103               
2          0          1          0          -0.0                
2          0          2          0          1.0                 
2          0          2          1          -0.866              
2          0          3          0          0.0                 
2          0          3          1          0.213               
2          0          3          2          -0.761              
2          1          1          0          0.484               
2          1          2          0          -0.866              
2          1          2          1          1.0                 
2          1          3          0          -0.065              
2          1          3          1          0.0                 
2          1          3          2          0.659               
3          0          1          0          -0.0                
3          0          2          0          0.0                 
3          0          2          1          -0.065              
3          0          3          0          1.0                 
3          0          3          1          -0.943              
3          0          3          2          0.632               
3          1          1          0          0.23                
3          1          2          0          0.213               
3          1          2          1          0.0                 
3          1          3          0          -0.943              
3          1          3          1          1.0                 
3          1          3          2          -0.745              
3          2          1          0          0.103               
3          2          2          0          -0.761              
3          2          2          1          0.659               
3          2          3          0          0.632               
3          2          3          1          -0.745              
3          2          3          2          1.0                 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">sph_harm</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">spherical_jn</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>
    
<span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="n">zero_l1n1</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
    <span class="n">zero_l2n2</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l1n1</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l2n2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">integrand_norm</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="n">zero_l1n1</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
    <span class="n">zero_l2n2</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r_norm</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">)</span><span class="o">*</span><span class="n">r_norm</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l1n1</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l2n2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">integrand_r3</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">l2</span><span class="p">):</span>
    <span class="n">zero_l1n1</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
    <span class="n">zero_l2n2</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l1n1</span><span class="p">)</span><span class="o">*</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">zero_l2n2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span>
<span class="k">def</span> <span class="nf">r_norm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="n">zero_ln</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">zero_ln</span><span class="p">))</span>
    
    
<span class="k">def</span> <span class="nf">spherical_jn_zero</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ngrid</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns nth zero of spherical bessel function of order l</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># calculate on a sensible grid</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">ngrid</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
        <span class="c1"># Find m good initial guesses from where y switches sign</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ind0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diffs</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="n">n</span><span class="p">]</span>  <span class="c1"># first m times sign of y changes</span>
        <span class="n">x0s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind0s</span><span class="p">]</span>
    
        <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">x0s</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand_norm</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">integrand_r3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
0.008240013
0.0044444399
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">r_norm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">beta_21</span> <span class="o">=</span> <span class="n">spherical_jn_zero</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spherical_jn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">beta_21</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">spherical_jn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">beta_21</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>121.35903188821808
0.01648002599297405
121.35903188821806
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">3.4.14.6.2. </span>Use in Quantum Mechanics<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>The <em><strong>Associated Laguerre Polynomials</strong></em> show up in the radial solution to the hydrogen atom.  They are a component of our understanding of radial wavefunctions for atoms and are thus extremely important.  They may come up as basis functions in approximation methods for many electron atoms.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./physical_chemistry/quantum_mechanics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="the_hydrogen_atom_absorption_spectrum.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.4.13. </span>The Hydrogen Atom Absorption Spectrum</p>
      </div>
    </a>
    <a class="right-next"
       href="the_helium_atom.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.4.15. </span>The Helium Atom</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">3.4.14.1. Motivation:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">3.4.14.2. Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-concepts">3.4.14.3. Coding Concepts:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#associated-legendre-polynomials">3.4.14.4. Associated Legendre Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-of-the-associated-legendre-polynomials">3.4.14.4.1. Orthogonality of the Associated Legendre Polynomials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-in-quantum-mechanics">3.4.14.4.2. Use in Quantum Mechanics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spherical-bessel-functions">3.4.14.5. Spherical Bessel Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-zeros-of-the-spherical-bessel-functions">3.4.14.5.1. The Zeros of the Spherical Bessel Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonality-of-the-spherical-bessel-functions">3.4.14.5.2. Orthogonality of the Spherical Bessel Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">3.4.14.5.3. Use in Quantum Mechanics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-associated-laguerre-polynomials">3.4.14.6. The Associated Laguerre Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limited-orthogonality-of-the-laguerre-polynomials">3.4.14.6.1. Limited Orthogonality of the Laguerre Polynomials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.4.14.6.2. Use in Quantum Mechanics</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Martin McCullagh
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>